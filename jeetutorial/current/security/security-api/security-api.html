<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using Jakarta Security :: Jakarta EE Documentation</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
    <script>!function (theme) {
        if (theme === 'dark') document.documentElement.classList.add('theme-dark')
      }(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)') && 'dark'))
    </script>
      </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a id="site-title" class="navbar-item" href="../../../..">Jakarta EE Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
<!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
 -->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="../../../../jakartaee-tutorial/10/jakarta-ee-tutorial.pdf">Download</a>
          </span>
        </div>
      </div>
      <div class="navbar-theme-switcher">
        <span class="switch" title="Switch between Light and Dark Theme">
          <input id="theme-switcher-checkbox" type="checkbox" />
          <label for="theme-switcher-checkbox">Dark Theme</label>
        </span>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jakartaee-tutorial" data-version="10">
  <div class="toolbar"></div>
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Jakarta EE Tutorial</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/overview/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/usingexamples/usingexamples.html">Using the Tutorial Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Core Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basic/cdi-basic.html">Introduction to Jakarta Contexts and Dependency Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basicexamples/cdi-basicexamples.html">Running the Basic Contexts and Dependency Injection Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/interceptors/interceptors.html">Using Jakarta EE Interceptors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs/jaxrs.html">Building RESTful Web Services with Jakarta REST</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-client/jaxrs-client.html">Accessing REST Resources with the Jakarta REST Client API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-advanced/jaxrs-advanced.html">Jakarta REST: Advanced Topics and an Example</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta JSON</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonb/jsonb.html">JSON Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonp/jsonp.html">JSON Processing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Full</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv/cdi-adv.html">Jakarta Contexts and Dependency Injection: Advanced Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-bootstrap-se8/cdi-bootstrap-se8.html">Bootstrapping a CDI Container in Java SE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv-examples/cdi-adv-examples.html">Running the Advanced Contexts and Dependency Injection Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Validation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation/bean-validation.html">Introduction to Jakarta Bean Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation-advanced/bean-validation-advanced.html">Bean Validation: Advanced Topics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security.html">Jakarta Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Servlets</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webapp/webapp.html">Getting Started with Web Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/servlets/servlets.html">Jakarta Servlet Technology</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Faces</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-intro/faces-intro.html">Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-facelets/faces-facelets.html">Introduction to Facelets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page/faces-page.html">Using Jakarta Faces Technology in Web Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page-core/faces-page-core.html">Using Converters, Listeners, and Validators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-develop/faces-develop.html">Developing with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ajax/faces-ajax.html">Using Ajax with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-advanced-cc/faces-advanced-cc.html">Composite Components: Advanced Topics and an Example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-custom/faces-custom.html">Creating Custom UI Components and Other Custom Objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-configure/faces-configure.html">Configuring Jakarta Faces Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ws/faces-ws.html">Using WebSockets with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webi18n/webi18n.html">Internationalizing and Localizing Web Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../web/websocket/websocket.html">Jakarta WebSocket</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-intro/persistence-intro.html">Introduction to Jakarta Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-basicexamples/persistence-basicexamples.html">Running the Persistence Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-querylanguage/persistence-querylanguage.html">The Jakarta Persistence Query Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-criteria/persistence-criteria.html">Using the Criteria API to Create Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-string-queries/persistence-string-queries.html">Creating and Using String-Based Criteria Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-locking/persistence-locking.html">Controlling Concurrent Access to Entity Data with Locking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-entitygraphs/persistence-entitygraphs.html">Creating Fetch Plans with Entity Graphs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-cache/persistence-cache.html">Using a Second-Level Cache with Jakarta Persistence Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Enterprise Beans Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-intro/ejb-intro.html">Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-gettingstarted/ejb-gettingstarted.html">Getting Started with Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-basicexamples/ejb-basicexamples.html">Running the Enterprise Bean Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-async/ejb-async.html">Using Asynchronous Method Invocation in Session Beans</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../messaging/mail-api/mail-api.html">Jakarta Mail</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Messaging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-concepts/jms-concepts.html">Jakarta Messaging Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-examples/jms-examples.html">Jakarta Messaging Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../supporttechs/batch-processing/batch-processing.html">Jakarta Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Advanced</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security-authentication/security-authentication.html">Jakarta Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security-authorization/security-authorization.html">Jakarta Authorization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/transactions/transactions.html">Jakarta Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/concurrency-utilities/concurrency-utilities.html">Jakarta Concurrency</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/connectors/connectors.html">Jakarta Connectors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Optional Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-el/faces-el.html">Jakarta Expression Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Jakarta XML Binding</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Archived</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-pages/jakarta-pages.html">Jakarta Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-tags/jakarta-tags.html">Jakarta Tags</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/xml-websvcs/xml-websvcs.html">XML Web Services</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-full/ejb-full.html">Jakarta Enterprise Beans Full</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jakarta EE Tutorial</span>
    <span class="version">10</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Jakarta EE Tutorial</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">10</a>
        </li>
        <li class="version">
          <a href="../../../9.1/index.html">9.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Jakarta EE Tutorial</a></li>
    <li><a href="security-api.html">Using Jakarta Security</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">10</button>
  <div class="version-menu">
    <a class="version is-current" href="security-api.html">10</a>
    <a class="version" href="../../../9.1/security/security-api/security-api.html">9.1</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jhammen/jakartaee-tutorial/edit/main/src/main/antora/modules/security/pages/security-api/security-api.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Using Jakarta Security</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We are working on a fresh, updated Jakarta EE Tutorial. This section hasn&#8217;t yet been updated.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This chapter describes the authentication and credential validation functionality provided by Jakarta Security.
The API also defines a <code>SecurityContext</code> access point for programmatic security.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_jakarta_security"><a class="anchor" href="#_about_jakarta_security"></a>About Jakarta Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jakarta EE includes support for Jakarta Security, which defines portable, plug-in interfaces for authentication and identity stores, and a new injectable-type SecurityContext interface that provides an access point for programmatic security.
You can use the built-in implementations of these APIs, or define custom implementations.</p>
</div>
<div class="paragraph">
<p>Jakarta Security contains the following packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>jakarta.security.enterprise</code> package is the main Jakarta Security package and contains classes and interfaces that span authentication, authorization, and identity concerns.
<a href="#_main_classes_and_interfaces_in_enterprise">Main Classes and Interfaces in <code>jakarta.security.enterprise</code></a> lists the main class and interfaces in this package.</p>
</li>
<li>
<p>The <code>jakarta.security.enterprise.authentication.mechanism.http</code> package contains classes and interfaces associated with HTTP-based authentication mechanisms that can interact with a caller or third-parties as part of an authentication protocol.
<a href="#_main_classes_and_interfaces_in_authentication">Main Classes and Interfaces in <code>jakarta.security.enterprise.authentication.mechanism.http</code></a> lists the main classes and interfaces in this package.</p>
</li>
<li>
<p>The <code>jakarta.security.enterprise.credential</code> package contains classes and interfaces for representing user credentials.
<a href="#_main_classes_and_interfaces_in_credential">Main Classes and Interfaces in <code>jakarta.security.enterprise.credential</code></a> lists the main classes and interfaces in this package.</p>
</li>
<li>
<p>The <code>jakarta.security.enterprise.identitystore</code> package contains classes and interfaces associated with identity stores that validate a caller&#8217;s credentials and lookup caller groups.
<a href="#_main_classes_and_interfaces_in_identitystore">Main Classes and Interfaces in <code>jakarta.security.enterprise.identitystore</code></a> lists the main classes and interfaces in this package.</p>
</li>
</ul>
</div>
<table id="_main_classes_and_interfaces_in_enterprise" class="tableblock frame-all grid-all" style="width: 99%;">
<caption class="title">Main Classes and Interfaces in <code>jakarta.security.enterprise</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SecurityContext</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Injectable-type interface that provides an access point for programmatic security intended to be used by application code to query and interact with the Jakarta Security.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CallerPrincipal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Principal type that can represent the identity of the application caller.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthenticationStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enum used to indicate the return value from an authentication mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthenticationException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that a problem occurred during the authentication process.</p></td>
</tr>
</tbody>
</table>
<table id="_main_classes_and_interfaces_in_authentication" class="tableblock frame-all grid-all" style="width: 99%;">
<caption class="title">Main Classes and Interfaces in <code>jakarta.security.enterprise.authentication.mechanism.http</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpAuthenticationMechanism</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface representing an HTTP authentication mechanism.
Developers can provide their own implementation of this interface, or use one of several built-in HTTP authentication mechanisms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpMessageContext</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface representing the parameters passed to/from methods of an <code>HttpAuthenticationMechanism</code> at runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthenticationParameters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class that carries parameters passed to the <code>SecurityContext.authenticate()</code> method.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpMessageContextWrapper</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract class developers can extend to customize <code>HttpMessageContext</code> behavior.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>jakarta.security.enterprise.authentication.mechanism.http</code> package also includes a number of annotation classes that are used to configure/enable the built-in authentication mechanisms or to modify the behavior of an authentication mechanism.
</td>
</tr>
</table>
</div>
<table id="_main_classes_and_interfaces_in_credential" class="tableblock frame-all grid-all" style="width: 99%;">
<caption class="title">Main Classes and Interfaces in <code>jakarta.security.enterprise.credential</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Credential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface that represents a generic credential and defines several methods to operate on credentials.
All other classes in this package are implementations of the Credential interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AbstractClearableCredential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abstract class implementing behavior common to Credentials that can be meaningfully cleared.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BasicAuthenticationCredential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class that extends <code>UsernamePasswordCredential</code> to represent credentials used by HTTP Basic Authentication.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CallerOnlyCredential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Credential that contains a caller name only; can be used to assert an identity, but not to authenticate a user, due to the lack of any secret or other credential that can be validated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class that represents a text-based password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RememberMeCredential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class that represents a credential presented as a token, for the explicit usage with the Jakarta Security remember me function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UsernamePasswordCredential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class that represents the credentials typically used by standard caller name/password authentication.</p></td>
</tr>
</tbody>
</table>
<table id="_main_classes_and_interfaces_in_identitystore" class="tableblock frame-all grid-all" style="width: 99%;">
<caption class="title">Main Classes and Interfaces in <code>jakarta.security.enterprise.identitystore</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IdentityStore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface representing an Identity Store.
Developers can provide their own implementation of this interface, or use one of the built-in Identity Stores.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IdentityStoreHandler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface that defines the method applications use to interact with Identity Stores.
Applications can use the built-in IdentityStoreHandler, or supply their own implementation if custom behavior is desired.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PasswordHash</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface defining methods for generating and validating password hashes, needed to securely validate passwords when using the built-in Database Identity Store.
Developers can implement this interface to generate/validate password hashes using any desired algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pbkdf2PasswordHash</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marker interface implemented by the built-in PBKDF2 PasswordHash implementation.
Developers can use this interface to select the built-in PBKDF2 algorithm when configuring the Database Identity Store.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RememberMeIdentityStore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface defining a special type of Identity Store, used in conjunction with the RememberMe annotation to provide RememberMe behavior for an application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CredentialValidationResult</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class that represents the result from an attempt to validate a Credential.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IdentityStorePermission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission required to invoke the <code>getGroups</code> method of an IdentityStore, when a SecurityManager is configured.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_overview_of_the_http_authentication_mechanism_interface"><a class="anchor" href="#_overview_of_the_http_authentication_mechanism_interface"></a>Overview of the HTTP Authentication Mechanism Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>HttpAuthenticationMechanism</code> interface defines an SPI for writing authentication mechanisms that can be provided with an application and deployed using CDI.
Developers can write their own implementations of <code>HttpAuthenticationMechanism</code> to support specific authentication token types or protocols.
There are also several built-in authentication mechanisms that perform BASIC, FORM, and Custom FORM authentication.</p>
</div>
<div class="paragraph">
<p>The built-in authentication mechanisms are enabled and configured through the use of one of the following annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BasicAuthenticationMechanismDefinition</code>&#8201;&#8212;&#8201;implements BASIC authentication that conforms to the behavior of the servlet container when BASIC &lt;auth-method&gt; is declared in web.xml.</p>
</li>
<li>
<p><code>FormAuthenticationMechanismDefinition</code>&#8201;&#8212;&#8201;implements FORM authentication that conforms to the behavior of the servlet container when the FORM &lt;auth-method&gt; is declared in web.xml.</p>
</li>
<li>
<p><code>CustomFormAuthenticationMechanismDefinition</code>&#8201;&#8212;&#8201;implements a modified version of FORM authentication in which custom handling replaces the POST to j_security_check.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An implementation of HttpAuthenticationMechanism must be a CDI bean to be recognized and deployed at runtime, and is assumed to be normal scoped.
During bean discovery, the servlet container looks for a bean that implements <code>HttpAuthenticationMechanism</code>&#8201;&#8212;&#8201;there should be only one per application&#8201;&#8212;&#8201;and, if found, arranges for it to be deployed to authenticate the application&#8217;s callers.</p>
</div>
<div class="paragraph">
<p>The servlet container leverages Jakarta Authentication to deploy authentication mechanisms.
The container provides a Jakarta Authentication Server Auth Module (SAM) that can delegate to an <code>HttpAuthenticationMechanism</code>, and arranges for that "bridge" SAM to be registered with the Jakarta Authentication <code>AuthConfigFactory</code>.
At runtime, normal Jakarta Authentication processing invokes the bridge SAM, which then delegates to the <code>HttpAuthenticationMechanism</code> to perform the authentication and drive any necessary dialog with the caller, or with third parties involved in the authentication protocol flow.</p>
</div>
<div class="paragraph">
<p>The HttpAuthenticationMechanism interface defines the following three methods, which correspond to the three methods defined by the Jakarta Authentication ServerAuth interface.
When one of the Jakarta Authentication methods is invoked on the bridge SAM, it delegates to the corresponding method of the <code>HttpAuthenticationMechanism</code>.
Although the method names are identical, the method signatures are not; the bridge SAM maps back and forth between the parameters passed to it by the Jakarta Authentication framework, and the parameters expected by an <code>HttpAuthenticationMechanism</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>validateRequest()</code>&#8201;&#8212;&#8201;validate an incoming request and authenticates the caller.</p>
</li>
<li>
<p><code>secureResponse()</code>&#8201;&#8212;&#8201;(optional if default is sufficient) secure a response message.</p>
</li>
<li>
<p><code>cleanSubject()</code>&#8201;&#8212;&#8201;(optional if default is sufficient) clear the provided Subject of principals and credentials.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only the <code>validateRequest()</code> method must be implemented by an <code>HttpAuthenticationMechanism</code>; the interface includes default implementations for <code>secureResponse()</code> and <code>cleanSubject()</code> that will often be sufficient.</p>
</div>
<div class="paragraph">
<p>The following annotations can be used to add additional behaviors to an <code>HttpAuthenticationMechanism</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AutoApplySession</code>&#8201;&#8212;&#8201;indicates that the Jakarta Authentication <code>registerSession</code> functionality should be enabled such that the the caller&#8217;s authenticated identity is persisted in the caller&#8217;s servlet session.</p>
</li>
<li>
<p><code>LoginToContinue</code>&#8201;&#8212;&#8201;mechanism to specify properties for FORM login&#8201;&#8212;&#8201;login page, error page, etc.
The built-in FORM authentication mechanisms use LoginToContinue to configure the necessary parameters.</p>
</li>
<li>
<p><code>RememberMe</code>&#8201;&#8212;&#8201;specifies that a <code>RememberMe</code> identity store should be used to enable <code>RememberMe</code> functionality for the authentication mechanism.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview_of_the_identity_store_interfaces"><a class="anchor" href="#_overview_of_the_identity_store_interfaces"></a>Overview of the Identity Store Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Identity Store Interfaces are described in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_the_identitystore_interface">The IdentityStore Interface</a></p>
</li>
<li>
<p><a href="#_the_remembermeidentitystore_interface">The RememberMeIdentityStore Interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_identitystore_interface"><a class="anchor" href="#_the_identitystore_interface"></a>The IdentityStore Interface</h3>
<div class="paragraph">
<p>The <code>IdentityStore</code> interface defines an SPI for interacting with identity stores, which are directories or databases containing user account information.
An implementation of the <code>IdentityStore</code> interface can validate users' credentials, provide information about the groups they belong to, or both.
Most often, an <code>IdentityStore</code> implementation will interact with an external identity store&#8201;&#8212;&#8201;an LDAP server, for example&#8201;&#8212;&#8201;to perform the actual credential validation and group lookups, but an <code>IdentityStore</code> may also manage user account data itself.</p>
</div>
<div class="paragraph">
<p>There are two built-in implementations of <code>IdentityStore</code>: an LDAP identity store, and a Database identity store.
These identity stores delegate to external stores that must already exist; the IdentityStore implementations do not provide or manage the external store.
They are configured with the parameters necessary to communicate with an external store using the following annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LdapIdentityStoreDefinition</code>&#8201;&#8212;&#8201;configures an identity store with the parameters necessary to communicate with an external LDAP server, validate user credentials, and/or lookup user groups.</p>
</li>
<li>
<p><code>DatabaseIdentityStoreDefinition</code>&#8201;&#8212;&#8201;configures an identity store with the parameters necessary to connect to an external database, validate user credentials, and/or lookup user groups.
You must supply a PasswordHash implementation when configuring a Database Identity Store.
See <a href="#_the_passwordhash_interface">The PasswordHash Interface</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An application can provide its own custom identity store, or use the built-in LDAP or database identity stores.
For examples of both types, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_running_the_built_in_database_identity_store_example">Running the Built-In Database Identity Store Example</a></p>
</li>
<li>
<p><a href="#_running_the_custom_identity_store_example">Running the Custom Identity Store Example</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An implementation of <code>IdentityStore</code> must be a CDI bean to be recognized and deployed at runtime, and is assumed to be normal scoped.
IdentityStores are primarily intended for use by implementations of <code>HttpAuthenticationMechanisms</code>, but this is not a requirement.
They can be used by other types of authentication mechanisms as well, or by containers.</p>
</div>
<div class="paragraph">
<p>Multiple implementations of <code>IdentityStore</code> may be present.
If so, they are invoked under the control of an <code>IdentityStoreHandler</code>.</p>
</div>
<div class="sect3">
<h4 id="_identitystorehandler"><a class="anchor" href="#_identitystorehandler"></a>IdentityStoreHandler</h4>
<div class="paragraph">
<p>Authentication mechanisms do not interact with <code>IdentityStore</code> directly; instead, they call an <code>IdentityStoreHandler</code>.
An implementation of the <code>IdentityStoreHandler</code> interface provides a single method, <code>validate(Credential)</code>, which, when invoked, iterates over the available IdentityStores and returns an aggregated result.
An <code>IdentityStoreHandler</code> must also be a CDI bean, and is assumed to be normal scoped.
At runtime, an authentication mechanism injects the <code>IdentityStoreHandler</code> and invokes on it.
The <code>IdentityStoreHandler</code>, in turn, looks up the available IdentityStores and invokes on them to determine the aggregate result.</p>
</div>
<div class="paragraph">
<p>There is a built-in <code>IdentityStoreHandler</code> that implements a standard algorithm defined by Jakarta Security.
The Jakarta Security specification provides a full description of the algorithm, but it can be roughly summarized as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Iterate over the available validating IdentityStores, in priority order, until the provided Credential is validated or there are no more IdentityStores.</p>
</li>
<li>
<p>If the Credential was validated, iterate over the available group-providing IdentityStores, in priority order, aggregating the groups returned by each store.</p>
</li>
<li>
<p>Return the validated caller and group information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An application may also supply its own <code>IdentityStoreHandler</code>, which can use any desired algorithm to select and invoke on IdentityStores, and return an aggregated (or non-aggregated) result.</p>
</div>
</div>
<div class="sect3">
<h4 id="_identitystore_interface_methods"><a class="anchor" href="#_identitystore_interface_methods"></a>IdentityStore Interface Methods</h4>
<div class="paragraph">
<p>The IdentityStore interface itself has four methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>validate(Credential)</code>&#8201;&#8212;&#8201;validate a Credential, and return the result of that validation.</p>
</li>
<li>
<p><code>getCallerGroups(CredentialValidationResult)</code>&#8201;&#8212;&#8201;return the groups associated with the caller indicated by the supplied <code>CredentialValidationResult</code>, which represents the result of a previous, successful validation.</p>
</li>
<li>
<p><code>validationTypes()</code>&#8201;&#8212;&#8201;returns a Set of validation types (one or more of <code>VALIDATE</code>, <code>PROVIDE_GROUPS</code>) that indicate the operations supported by this instance of the <code>IdentityStore</code>.</p>
</li>
<li>
<p><code>priority()</code>&#8201;&#8212;&#8201;returns a positive integer representing the self-declared priority of this IdentityStore.
Lower values represent higher priority.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because <code>getCallerGroups()</code> is a sensitive operation&#8201;&#8212;&#8201;it can return information about arbitrary users, and does not require that the caller provide the user&#8217;s credential or proof of identity&#8201;&#8212;&#8201;the caller should have the <code>IdentityStorePermission("getGroups")</code> permission.
Enforcement of this check is incumbent on the implementation of the <code>getCallerGroups()</code> method; the built-in IdentityStores do check for this permission, if a SecurityManager is configured, and the built-in IdentityStoreHandler invokes the <code>getCallerGroups()</code> method in the context of a <code>PrivilegedAction</code> block.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_passwordhash_interface"><a class="anchor" href="#_the_passwordhash_interface"></a>The PasswordHash Interface</h4>
<div class="paragraph">
<p>Unlike some types of identity stores, for example LDAP directories, databases can store and retrieve user passwords, but can&#8217;t verify them natively.
Therefore, the built-in Database identity store must verify user passwords itself.
Most often, this involves generating a hash of the user&#8217;s password for comparison with a hash value stored in the database.</p>
</div>
<div class="paragraph">
<p>In order to provide maximum flexibility and interoperability, the Database identity store does not implement any specific password hashing algorithms.
Instead, it defines the <code>PasswordHash</code> interface, and expects the application to provide an implementation of <code>PasswordHash</code> that can verify passwords from the specific store the application will use.
The <code>PasswordHash</code> implementation must be made available as a dependent-scoped bean, and is configured by providing the fully-qualified name of the desired type as the <code>hashAlgorithm</code> value on a <code>DatabaseIdentityStoreDefinition</code>.</p>
</div>
<div class="paragraph">
<p>The <code>PasswordHash</code> algorithm defines three methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initialize(Map&lt;String,String&gt; parameters)</code>&#8201;&#8212;&#8201;initialize the PasswordHash with the supplied Map of parameters.
The Database identity store calls this method when initializing, passing the <code>hashAlgorithmParameters</code> value of the <code>DatabaseIdentityStoreDefinition</code> annotation (after conversion to a Map).</p>
</li>
<li>
<p><code>verify(char[] password, String hashedPassword)</code>&#8201;&#8212;&#8201;verify a caller-supplied password against the caller&#8217;s stored password hash as retrieved from the database.
The <code>hashedPassword</code> value should be provided exactly as it was returned from the database.</p>
</li>
<li>
<p><code>generate(char[] password)</code>&#8201;&#8212;&#8201;generate a password hash from the supplied password.
The value returned should be formatted and encoded exactly it would be stored in the database.
While it is useful to generate the hash of a caller-supplied password during <code>verify()</code>, this method is intended primarily for use by applications or <code>IdentityStore</code> implementations that want to support password management/reset capability without having to duplicate the code used to verify passwords.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that, while the interface is oriented toward hashing passwords, it can also support alternative approaches, such as two-way encryption of stored passwords.</p>
</div>
<div class="paragraph">
<p>There is a built-in <code>Pbkdf2PasswordHash</code> implementation that supports, as it&#8217;s name suggests, PBKDF2 password hashing.
It supports several parameters that control the generation of hash values (key size, iterations, and so on&#8201;&#8212;&#8201;see the Javadoc), and those parameters are encoded into the resulting hash value, so that hashes can be verified even if the currently configured parameters are different from the parameters in effect when a stored hash was generated.</p>
</div>
<div class="paragraph">
<p>While it is necessary to write a custom <code>PasswordHash</code> to enable interoperability with a legacy identity store that stores password hashes in a format other than the <code>Pbkdf2PasswordHash</code> format, developers should consider carefully whether <code>Pbkdf2PasswordHash</code> is sufficient for new identity stores, and avoid writing a new PasswordHash implementation without a solid understanding of the cryptographic and other security considerations involved.
Some of the considerations specific to password hashing are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The requirements for hashing passwords differ considerably from the requirements for hashing in other contexts.
In particular, speed is normally a virtue when generating hashes, but when generating password hashes, slower is better&#8201;&#8212;&#8201;to slow down brute force attacks against hashed values.</p>
</li>
<li>
<p>The comparison of a generated hash with a stored hash should take constant time, whether it succeeds or fails, in order to avoid giving an attacker clues about the password value based on the timing of failed attempts.</p>
</li>
<li>
<p>A new random salt should be used each time a new password hash value is generated.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_remembermeidentitystore_interface"><a class="anchor" href="#_the_remembermeidentitystore_interface"></a>The RememberMeIdentityStore Interface</h3>
<div class="paragraph">
<p>The <code>RememberMeIdentityStore</code> interface represents a special type of identity store.
It is not directly related to the <code>IdentityStore</code> interface; that is, it does not implement or extend it.
It does, however, perform a similar, albeit specialized, function.</p>
</div>
<div class="paragraph">
<p>In some cases, an application wants to "remember" a user&#8217;s authenticated session for an extended period.
For example, a web site may remember you when you visit, and prompt for your password only periodically, perhaps once every two weeks, as long as you don&#8217;t explicitly log out.</p>
</div>
<div class="paragraph">
<p>RememberMe works as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a request from an unauthenicated user is received, the user is authenticated using an <code>HttpAuthenticationMechanism</code> that is provided by the application (this is required&#8201;&#8212;&#8201;<code>RememberMeIdentityStore</code> can only be used in conjunction with an application-supplied <code>HttpAuthenticationMechanism</code>).</p>
</li>
<li>
<p>After authentication, the configured <code>RememberMeIdentityStore</code> saves information about the user&#8217;s authenticated identity, so that it be restored later, and generates a long-lived "remember me" login token that is sent back to the client, perhaps as a cookie.</p>
</li>
<li>
<p>On a subsequent visit to the application, the client presents the login token.
The <code>RememberMeIdentityStore</code> then validates the token and returns the stored user identity, which is then established as the user&#8217;s authenticated identity.
If the token is invalid or expired, it is discarded, the user is authenticated normally again, and a new login token is generated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>RememberMeIdentityStore</code> interface defines the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>generateLoginToken(CallerPrincipal caller, Set&lt;String&gt; groups)</code>&#8201;&#8212;&#8201;generate a login token for a newly authenticated user, and associate it with the provided caller/group information.</p>
</li>
<li>
<p><code>removeLoginToken(String token)</code>&#8201;&#8212;&#8201;remove the (presumably expired or invalid) login token and any associated caller/group information.</p>
</li>
<li>
<p><code>validate(RememberMeCredential credential)</code>&#8201;&#8212;&#8201;validate the supplied credential, and, if valid, return the associated caller/group information.
(<code>RememberMeCredential</code> is essentially just a holder for a login token).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An implementation of <code>RememberMeIdentityStore</code> must be a CDI bean, and is assumed to be normal scoped.
It is configured by adding a <code>RememberMe</code> annotation to an application&#8217;s <code>HttpAuthenticationMechanism</code>, which indicates that a <code>RememberMeIdentityStore</code> is in use, and provides related configuration parameters.
A container-supplied interceptor then intercepts calls to the <code>HttpAuthenticationMechanism</code>, invokes the <code>RememberMeIdentityStore</code> as necessary before and after calls to the authentication mechanism, and ensures that the user&#8217;s identity is correctly set for the session.
The Jakarta Security specification provides a detailed description of the required interceptor behavior.</p>
</div>
<div class="paragraph">
<p>Implementations of <code>RememberMeIdentityStore</code> should take care to manage tokens and user identity information securely.
For example, login tokens should not contain sensitive user information, like credentials or sensitive attributes, to avoid exposing that information if an attacker were able to gain access to the token&#8201;&#8212;&#8201;even an encrypted token is potentially vulnerable to an attacker with sufficient time/resources.
Similarly, tokens should be encrypted/signed wherever possible, and sent only over secure channels (HTTPS).
User identity information managed by a <code>RememberMeIdentityStore</code> should be stored as securely as possible (but does not necessarily need to be reliably persisted&#8201;&#8212;&#8201;the only impact of a "forgotten" session is that the user will be prompted to log in again).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_built_in_database_identity_store_example"><a class="anchor" href="#_running_the_built_in_database_identity_store_example"></a>Running the Built-In Database Identity Store Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The example described in this section demonstrates how to use the built-in database identity store for credential validation.</p>
</div>
<div class="paragraph">
<p>Topics include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_overview_of_the_built_in_database_identity_store_example">Overview of the Built-In Database Identity Store Example</a></p>
</li>
<li>
<p><a href="#_running_the_built_in_db_identity_store_example">Running the built-in-db-identity-store Example</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_overview_of_the_built_in_database_identity_store_example"><a class="anchor" href="#_overview_of_the_built_in_database_identity_store_example"></a>Overview of the Built-In Database Identity Store Example</h3>
<div class="paragraph">
<p>Jakarta Security mandates that a Jakarta EE container MUST support a built-in <code>IdentityStore</code> backed by a database.
To support this mandatory requirement, <code>DatabaseIdentityStore</code> is bundled with GlassFish.</p>
</div>
<div class="paragraph">
<p>This example demonstrates how you can configure a <code>DatabaseIdentityStore</code> to point to a backend database and then use it as an IdentityStore.
The authentication mechanism used is <code>BasicAuthenticationMechanism</code>.</p>
</div>
<div class="paragraph">
<p>The source code for this example is in the <code><em>jakartaee-examples</em>/tutorial/security/security-api/built-in-db-identity-store</code> directory.</p>
</div>
<div class="paragraph">
<p>The following sections describe the high-level process for configuring the <code>DatabaseIdentityStore</code>.
Note that the configuration described in these sections has already been completed in the application files, but is provided here to illustrate what you need to do to use the built-in database identity store.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_define_the_users_and_groups_in_the_identity_store">Define the Users and Groups in the Identity Store</a></p>
</li>
<li>
<p><a href="#_map_the_databaseidentitystore_to_the_default_data_source">Map the DatabaseIdentityStore to the Default Data source</a></p>
</li>
<li>
<p><a href="#_specify_the_authentication_mechanism">Specify the Authentication Mechanism</a></p>
</li>
<li>
<p><a href="#_declare_roles_in_the_servlet_container">Declare Roles in the Servlet Container</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a request that includes credentials is sent to the application, it triggers the configured authentication mechanism and authentication is performed against the <code>DatabaseIdentityStore</code> as defined in the application.</p>
</div>
<div class="paragraph">
<p>Post authentication, the application also verifies the roles the caller is in and sends the details as part of the response.</p>
</div>
<div class="paragraph">
<p>Note that in GlassFish, if the user provides the wrong credentials when using <code>BasicAuthenticationMechanism</code>, then the <code>realmName</code> is presented to user, as a hint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">curl -I -u Joe http://localhost:8080/built-in-db-identity-store/servlet
Enter host password for user 'Joe':
HTTP/1.1 401 Unauthorized
Server: Eclipse GlassFish  6.0.0
X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish  6.0.0  Java/AdoptOpenJDK/1.8)
WWW-Authenticate: Basic realm="file"
Content-Length: 1056
Content-Language:
Content-Type: text/html</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_define_the_users_and_groups_in_the_identity_store"><a class="anchor" href="#_define_the_users_and_groups_in_the_identity_store"></a>Define the Users and Groups in the Identity Store</h4>
<div class="paragraph">
<p>The following table shows the users, passwords, and groups used in this example.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 40%;">
<colgroup>
<col style="width: 30%;">
<col style="width: 40%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User</th>
<th class="tableblock halign-left valign-top">Password</th>
<th class="tableblock halign-left valign-top">Group</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo, bar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sam</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo, bar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following code shows how to define credentials and the roles assigned to users in the <code>DatabaseSetup.java</code> file.</p>
</div>
<div class="paragraph">
<p>With <code>@Startup</code> annotation, this singleton enterprise bean is initialized during application startup and the credentials are set in the underlying database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import jakarta.annotation.Resource;
import jakarta.annotation.sql.DataSourceDefinition;
import jakarta.ejb.Singleton;
import jakarta.ejb.Startup;
import jakarta.sql.DataSource;

@Singleton
@Startup
public class DatabaseSetup {

    // The default datasource that is bundled with GlassFish is used to store // credentials.
    @Resource(lookup="java:comp/DefaultDataSource")
    private DataSource dataSource;

    @PostConstruct
    public void init() {

        // ...
        executeUpdate(dataSource, "INSERT INTO caller VALUES('Joe', '" + passwordHash.generate("secret1".toCharArray()) + "')");
        // ...
        executeUpdate(dataSource, "INSERT INTO caller_groups VALUES('Joe', 'foo')");
        executeUpdate(dataSource, "INSERT INTO caller_groups VALUES('Joe', 'bar')");
        // ...
    }

    @PreDestroy
    public void destroy() {
    	// ...
    }

    private void executeUpdate(DataSource dataSource, String query) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_map_the_databaseidentitystore_to_the_default_data_source"><a class="anchor" href="#_map_the_databaseidentitystore_to_the_default_data_source"></a>Map the DatabaseIdentityStore to the Default Data source</h4>
<div class="paragraph">
<p>Use the <code>@DatabaseIdentityStoreDefinition</code> annotation to map the built-in <code>DatabaseIdentityStore</code> to the <code>DefaultDataSource</code> in the <code>ApplicationConfig.java</code> file.
This example also demonstrates the use of the <code>Pbkdf2PasswordHash</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Database Definition for built-in DatabaseIdentityStore
@DatabaseIdentityStoreDefinition(
    callerQuery = "#{'select password from caller where name = ?'}",
    groupsQuery = "select group_name from caller_groups where caller_name = ?",
    hashAlgorithm = Pbkdf2PasswordHash.class,
    priorityExpression = "#{100}",
    hashAlgorithmParameters = {
        "Pbkdf2PasswordHash.Iterations=3072",
        "${applicationConfig.dyna}"
    }
)

@ApplicationScoped
@Named
public class ApplicationConfig {

  public String[] getDyna() {
       return new String[]{"Pbkdf2PasswordHash.Algorithm=PBKDF2WithHmacSHA512", "Pbkdf2PasswordHash.SaltSizeBytes=64"};
   }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_specify_the_authentication_mechanism"><a class="anchor" href="#_specify_the_authentication_mechanism"></a>Specify the Authentication Mechanism</h4>
<div class="paragraph">
<p>In this application, credentials are validated using the BASIC authentication mechanism.
Specify the <code>@BasicAuthenticationMechanismDefinition</code> annotation in the <code>ApplicationConfig.java</code> to ensure that the <code>BasicAuthenticationMechanism</code> is used to perform credential validation.</p>
</div>
<div class="paragraph">
<p>When a request is made to the servlet in question, the container delegates the request to <code>org.glassfish.soteria.mechanisms.jaspic.HttpBridgeServerAuthModule</code>, which then invokes the <code>BasicAuthenticationMechanism#validateRequest</code> method, and gets the credential from the request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BasicAuthenticationMechanismDefinition(
        realmName = "file"
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_declare_roles_in_the_servlet_container"><a class="anchor" href="#_declare_roles_in_the_servlet_container"></a>Declare Roles in the Servlet Container</h4>
<div class="paragraph">
<p>When a request is made to the application, the roles the user is in are returned as part of the response.
Note that the container needs to be made aware of the supported roles, which are defined using the <code>@DeclareRoles({ "foo", "bar", "kaz" })</code> annotation as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@WebServlet("/servlet")
@DeclareRoles({ "foo", "bar", "kaz" })
@ServletSecurity(@HttpConstraint(rolesAllowed = "foo"))
public class Servlet extends HttpServlet {

    private static final long serialVersionUID = 1L;

    @Override
    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        String webName = null;
        if (request.getUserPrincipal() != null) {
            webName = request.getUserPrincipal().getName();
        }

        response.getWriter().write("web username: " + webName + "\n");

        response.getWriter().write("web user has role \"foo\": " + request.isUserInRole("foo") + "\n");
        response.getWriter().write("web user has role \"bar\": " + request.isUserInRole("bar") + "\n");
        response.getWriter().write("web user has role \"kaz\": " + request.isUserInRole("kaz") + "\n");
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In GlassFish 6.0, group to role mapping is enabled by default.
Therefore, you do not need to bundle web.xml with the application to provide mapping between roles and groups.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_built_in_db_identity_store_example"><a class="anchor" href="#_running_the_built_in_db_identity_store_example"></a>Running the built-in-db-identity-store Example</h3>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and run the <code>built-in-db-identity-store</code> application as described in the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_to_build_package_and_deploy_the_built_in_db_identity_store_example_using_netbeans_ide">To Build, Package, and Deploy the built-in-db-identity-store Example Using NetBeans IDE</a></p>
</li>
<li>
<p><a href="#_to_build_package_and_deploy_the_built_in_db_identity_store_example_using_maven">To Build, Package, and Deploy the built-in-db-identity-store Example Using Maven</a></p>
</li>
<li>
<p><a href="#_to_run_the_built_in_db_identity_store_example">To Run the built-in-db-identity-store Example</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_to_build_package_and_deploy_the_built_in_db_identity_store_example_using_netbeans_ide"><a class="anchor" href="#_to_build_package_and_deploy_the_built_in_db_identity_store_example_using_netbeans_ide"></a>To Build, Package, and Deploy the built-in-db-identity-store Example Using NetBeans IDE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you have not already done so, start the default database.
This is necessary because we are using the DefaultDataSource bundled with GlassFish for <code>DatabaseIdentityStore</code>.
See <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_apache_derby" class="xref page">Starting and Stopping Apache Derby</a>.</p>
</li>
<li>
<p>If you have not already done so, start the GlassFish server.
See <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_glassfish_server" class="xref page">Starting and Stopping GlassFish Server</a>.</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/security/security-api</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>built-in-db-identity-store</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>built-in-db-identity-store</code> project and select Build.</p>
<div class="paragraph">
<p>This command builds and deploys the example application to your GlassFish Server instance.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_to_build_package_and_deploy_the_built_in_db_identity_store_example_using_maven"><a class="anchor" href="#_to_build_package_and_deploy_the_built_in_db_identity_store_example_using_maven"></a>To Build, Package, and Deploy the built-in-db-identity-store Example Using Maven</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you have not already done so, start the default database.
This is necessary because we are using the DefaultDataSource bundled with GlassFish for <code>DatabaseIdentityStore</code>.
See <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_apache_derby" class="xref page">Starting and Stopping Apache Derby</a>.</p>
</li>
<li>
<p>If you have not already done so, start the GlassFish server. See
<a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_glassfish_server" class="xref page">Starting and Stopping GlassFish Server</a>.</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/security/security-api/built-in-db-identity-store</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file, <code>built-in-db-identity-store.war</code>, that is located in the <code>target</code> directory, then deploys the WAR file.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_to_run_the_built_in_db_identity_store_example"><a class="anchor" href="#_to_run_the_built_in_db_identity_store_example"></a>To Run the built-in-db-identity-store Example</h4>
<div class="paragraph">
<p>In this example, use the credentials of user Joe to make a request and to validate the response according to the credentials/roles defined in <code>DatabaseSetup.java</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a request to the deployed application by entering the following request URL in your web browser:</p>
<div class="paragraph">
<p>Request URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">http://localhost:8080/built-in-db-identity-store/servlet</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because BASIC authentication is being used here, the container responds back prompting for username and password.</p>
</div>
</li>
<li>
<p>Enter the username <code>Joe</code>, and the password <code>secret1</code> at the prompt.</p>
<div class="paragraph">
<p>Once you provide the credentials, the following process occurs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The client presents the request to the container with base64 encoded string and with the <code>Authorization</code> header using the value in the format expected for basic authentication.</p>
</li>
<li>
<p>With the username and password available to the container, validation is performed against <code>DatabaseIdentityStore</code>.</p>
</li>
<li>
<p>The corresponding <code>UsernamePasswordCredential</code> object is passed as a parameter to the <code>DatabaseIdentityStore#validate()</code> method.</p>
</li>
<li>
<p>The password is fetched from the database for user Joe.</p>
</li>
<li>
<p>The password stored in the database is hashed using the <code>PBKDF2</code> algorithm and verified by the built-in <code>Pbkdf2PasswordHash</code> implementation.</p>
</li>
<li>
<p>On successful verification, the request gets delegated to the servlet in question and the following response is returned to the end user.</p>
<div class="paragraph">
<p>Response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">web username: Joe
web user has role "foo": true
web user has role "bar": true
web user has role "kaz": false</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Test the authentication using invalid credentials.
Make a request to the deployed application by entering the following request URL in your web browser:</p>
<div class="paragraph">
<p>Request URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">http://localhost:8080/built-in-db-identity-store/servlet</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, because BASIC authentication is being used here, the container responds back prompting for username and password.</p>
</div>
</li>
<li>
<p>Enter an invalid username and password.
You are promted to enter the credentials again, but you are not authenticated.</p>
<div class="paragraph">
<p>When you click Cancel in the Authentication required window, the following response is returned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">HTTP Status 401 - Unauthorized

type Status report

message Unauthorized

description This request requires HTTP authentication.

Eclipse GlassFish 6.0.0</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_custom_identity_store_example"><a class="anchor" href="#_running_the_custom_identity_store_example"></a>Running the Custom Identity Store Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The example described in this section demonstrates how to bundle and use a custom identity store in your application for credential validation.</p>
</div>
<div class="paragraph">
<p>Topics include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_overview_of_the_custom_identity_store_example">Overview of the Custom Identity Store Example</a></p>
</li>
<li>
<p><a href="#_running_the_custom_identity_store_example_2">Running the custom-identity-store Example</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_overview_of_the_custom_identity_store_example"><a class="anchor" href="#_overview_of_the_custom_identity_store_example"></a>Overview of the Custom Identity Store Example</h3>
<div class="paragraph">
<p>As an alternative to using a built-in identity store, an application can provide its own IdentityStore.
When bundled with the application, this custom identity store can then be used for authentication and authorization.</p>
</div>
<div class="paragraph">
<p>This example demonstrates how to define a custom identity store, <code>TestIdentityStore</code>, and provide it as part of the application being deployed.
The authentication mechanism used is <code>BasicAuthenticationMechanism</code>.</p>
</div>
<div class="paragraph">
<p>The source code for this example is in the <code><em>jakartaee-examples</em>/tutorial/security/security-api/custom-identity-store</code> directory.</p>
</div>
<div class="paragraph">
<p>The following sections describe the high-level process for defining the <code>TestIdentityStore</code>.
Note that the configuration described in these sections has already been completed in the application files, but is provided here to illustrate what you need to do to use a custom identity store.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_define_the_users_and_groups_in_the_identity_store">Define the Users and Groups in the Identity Store</a></p>
</li>
<li>
<p><a href="#_specify_the_authentication_mechanism">Specify the Authentication Mechanism</a></p>
</li>
<li>
<p><a href="#_declare_roles_in_the_servlet_container">Declare Roles in the Servlet Container</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a request that includes credentials is sent to the application, the configured authentication mechanism comes into effect and authentication is performed against the <code>TestIdentityStore</code> as defined in the application.</p>
</div>
<div class="paragraph">
<p>Post authentication, the application also verifies the roles the caller is in and sends the details as part of the response.</p>
</div>
<div class="paragraph">
<p>Note that in GlassFish, if the user provides the wrong credentials when using <code>BasicAuthenticationMechanism</code>, then the <code>realmName</code> is presented to user, as a hint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">curl -I -u Joe http://localhost:8080/custom-identity-store/servlet
Enter host password for user 'Joe':
HTTP/1.1 401 Unauthorized
Server: Eclipse GlassFish  6.0.0
X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish  6.0.0  Java/AdoptOpenJDK/1.8)
WWW-Authenticate: Basic realm="file"
Content-Length: 1056
Content-Language:
Content-Type: text/html</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_define_the_users_and_groups_in_the_identity_store_2"><a class="anchor" href="#_define_the_users_and_groups_in_the_identity_store_2"></a>Define the Users and Groups in the Identity Store</h4>
<div class="paragraph">
<p>The following table shows the user, password, and group used in this example.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 40%;">
<colgroup>
<col style="width: 30%;">
<col style="width: 40%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User</th>
<th class="tableblock halign-left valign-top">Password</th>
<th class="tableblock halign-left valign-top">Group</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo, bar</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following code snippet shows how you define the credentials and the roles assigned to users in the <code>TestIdentityStore.java</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if (usernamePasswordCredential.compareTo("Joe", "secret1")) {
    return new CredentialValidationResult("Joe", new HashSet&lt;&gt;(asList("foo", "bar")));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_specify_the_authentication_mechanism_2"><a class="anchor" href="#_specify_the_authentication_mechanism_2"></a>Specify the Authentication Mechanism</h4>
<div class="paragraph">
<p>In this application, credentials are validated using the BASIC authentication mechanism.
Specify the <code>@BasicAuthenticationMechanismDefinition</code> annotation in the <code>ApplicationConfig.java</code> to ensure that the <code>BasicAuthenticationMechanism</code> is used to perform credential validation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@BasicAuthenticationMechanismDefinition(
        realmName = "file"
)

@ApplicationScoped
@Named
public class ApplicationConfig {

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_declare_roles_in_the_servlet_container_2"><a class="anchor" href="#_declare_roles_in_the_servlet_container_2"></a>Declare Roles in the Servlet Container</h4>
<div class="paragraph">
<p>When a request is made to the application, the roles the user is in are returned as part of the response.
Note that the container needs to be made aware of the supported roles, which are defined using the <code>@Declareroles({ "foo", "bar", "kaz" })</code> annotation as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@DeclareRoles({ "foo", "bar", "kaz" })
@WebServlet("/servlet")
public class Servlet extends HttpServlet {

    private static final long serialVersionUID = 1L;

    @Override
    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        String webName = null;
        if (request.getUserPrincipal() != null) {
            webName = request.getUserPrincipal().getName();
        }

        response.getWriter().write("web username: " + webName + "\n");

        response.getWriter().write("web user has role \"foo\": " + request.isUserInRole("foo") + "\n");
        response.getWriter().write("web user has role \"bar\": " + request.isUserInRole("bar") + "\n");
        response.getWriter().write("web user has role \"kaz\": " + request.isUserInRole("kaz") + "\n");
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In GlassFish 6.0, group to role mapping is enabled by default.
Therefore, you do not need to bundle <code>web.xml</code> with the application to provide mapping between roles and groups.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_custom_identity_store_example_2"><a class="anchor" href="#_running_the_custom_identity_store_example_2"></a>Running the custom-identity-store Example</h3>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and run the <code>custom-identity-store</code> application as described in the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_to_build_package_and_deploy_the_custom_identity_store_example_using_netbeans_ide">To Build, Package, and Deploy the custom-identity-store Example Using NetBeans IDE</a></p>
</li>
<li>
<p><a href="#_to_build_package_and_deploy_the_custom_identity_store_example_using_maven">To Build, Package, and Deploy the custom-identity-store Example Using Maven</a></p>
</li>
<li>
<p><a href="#_to_run_the_custom_identity_store_example">To Run the custom-identity-store Example</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_to_build_package_and_deploy_the_custom_identity_store_example_using_netbeans_ide"><a class="anchor" href="#_to_build_package_and_deploy_the_custom_identity_store_example_using_netbeans_ide"></a>To Build, Package, and Deploy the custom-identity-store Example Using NetBeans IDE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you have not already done so, start the GlassFish server.
See <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_glassfish_server" class="xref page">Starting and Stopping GlassFish Server</a>.</p>
</li>
<li>
<p>From the File menu, choose Open Project.</p>
</li>
<li>
<p>In the Open Project dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/security/security-api</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>custom-identity-store</code> folder.</p>
</li>
<li>
<p>Click Open Project.</p>
</li>
<li>
<p>In the Projects tab, right-click the <code>custom-identity-store</code> project and select Build.</p>
<div class="paragraph">
<p>This command builds and deploys the example application to your GlassFish Server instance.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_to_build_package_and_deploy_the_custom_identity_store_example_using_maven"><a class="anchor" href="#_to_build_package_and_deploy_the_custom_identity_store_example_using_maven"></a>To Build, Package, and Deploy the custom-identity-store Example Using Maven</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you have not already done so, start the GlassFish server.
See <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_glassfish_server" class="xref page">Starting and Stopping GlassFish Server</a>.</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/security/security-api/custom-identity-store</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds and packages the application into a WAR file, <code>custom-identity-store.war</code>, that is located in the <code>target</code> directory, then deploys the WAR file.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_to_run_the_custom_identity_store_example"><a class="anchor" href="#_to_run_the_custom_identity_store_example"></a>To Run the custom-identity-store Example</h4>
<div class="paragraph">
<p>In this example, use the credentials of user <code>Joe</code> to make a request and to validate the response according to the credentials defined in <code>TestIdentityStore</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a request to the deployed application using valid credentials by entering the following request URL in your web browser:</p>
<div class="paragraph">
<p>Request URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">http://localhost:8080/custom-identity-store/servlet?name=Joe&amp;password=secret1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">web username: Joe
web user has role "foo": true
web user has role "bar": true
web user has role "kaz": false</code></pre>
</div>
</div>
</li>
<li>
<p>Test the authentication using invalid credentials.
Make a request to the deployed application by entering the following request URL in your web browser:</p>
<div class="paragraph">
<p>Request URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">http://localhost:8080/custom-identity-store/servlet?name=Joe&amp;password=secret3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">HTTP Status 401 - Unauthorized

type Status report

message Unauthorized

description This request requires HTTP authentication.

Eclipse GlassFish 6.0.0</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
