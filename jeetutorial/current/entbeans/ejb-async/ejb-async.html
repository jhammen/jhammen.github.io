<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using Asynchronous Method Invocation in Session Beans :: Jakarta EE Documentation</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
    <script>!function (theme) {
        if (theme === 'dark') document.documentElement.classList.add('theme-dark')
      }(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)') && 'dark'))
    </script>
      </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a id="site-title" class="navbar-item" href="../../../..">Jakarta EE Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
<!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
 -->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="../../../../jakartaee-tutorial/10/jakarta-ee-tutorial.pdf">Download</a>
          </span>
        </div>
      </div>
      <div class="navbar-theme-switcher">
        <span class="switch" title="Switch between Light and Dark Theme">
          <input id="theme-switcher-checkbox" type="checkbox" />
          <label for="theme-switcher-checkbox">Dark Theme</label>
        </span>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jakartaee-tutorial" data-version="10">
  <div class="toolbar"></div>
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Jakarta EE Tutorial</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/overview/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/usingexamples/usingexamples.html">Using the Tutorial Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Core Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basic/cdi-basic.html">Introduction to Jakarta Contexts and Dependency Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basicexamples/cdi-basicexamples.html">Running the Basic Contexts and Dependency Injection Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/interceptors/interceptors.html">Using Jakarta EE Interceptors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs/jaxrs.html">Building RESTful Web Services with Jakarta REST</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-client/jaxrs-client.html">Accessing REST Resources with the Jakarta REST Client API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-advanced/jaxrs-advanced.html">Jakarta REST: Advanced Topics and an Example</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta JSON</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonb/jsonb.html">JSON Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonp/jsonp.html">JSON Processing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Full</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv/cdi-adv.html">Jakarta Contexts and Dependency Injection: Advanced Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-bootstrap-se8/cdi-bootstrap-se8.html">Bootstrapping a CDI Container in Java SE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv-examples/cdi-adv-examples.html">Running the Advanced Contexts and Dependency Injection Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Validation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation/bean-validation.html">Introduction to Jakarta Bean Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation-advanced/bean-validation-advanced.html">Bean Validation: Advanced Topics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../security/security.html">Jakarta Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Servlets</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webapp/webapp.html">Getting Started with Web Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/servlets/servlets.html">Jakarta Servlet Technology</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Faces</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-intro/faces-intro.html">Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-facelets/faces-facelets.html">Introduction to Facelets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page/faces-page.html">Using Jakarta Faces Technology in Web Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page-core/faces-page-core.html">Using Converters, Listeners, and Validators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-develop/faces-develop.html">Developing with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ajax/faces-ajax.html">Using Ajax with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-advanced-cc/faces-advanced-cc.html">Composite Components: Advanced Topics and an Example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-custom/faces-custom.html">Creating Custom UI Components and Other Custom Objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-configure/faces-configure.html">Configuring Jakarta Faces Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ws/faces-ws.html">Using WebSockets with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webi18n/webi18n.html">Internationalizing and Localizing Web Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../web/websocket/websocket.html">Jakarta WebSocket</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-intro/persistence-intro.html">Introduction to Jakarta Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-basicexamples/persistence-basicexamples.html">Running the Persistence Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-querylanguage/persistence-querylanguage.html">The Jakarta Persistence Query Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-criteria/persistence-criteria.html">Using the Criteria API to Create Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-string-queries/persistence-string-queries.html">Creating and Using String-Based Criteria Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-locking/persistence-locking.html">Controlling Concurrent Access to Entity Data with Locking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-entitygraphs/persistence-entitygraphs.html">Creating Fetch Plans with Entity Graphs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-cache/persistence-cache.html">Using a Second-Level Cache with Jakarta Persistence Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Enterprise Beans Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ejb-intro/ejb-intro.html">Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ejb-gettingstarted/ejb-gettingstarted.html">Getting Started with Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ejb-basicexamples/ejb-basicexamples.html">Running the Enterprise Bean Examples</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="ejb-async.html">Using Asynchronous Method Invocation in Session Beans</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../messaging/mail-api/mail-api.html">Jakarta Mail</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Messaging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-concepts/jms-concepts.html">Jakarta Messaging Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-examples/jms-examples.html">Jakarta Messaging Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../supporttechs/batch-processing/batch-processing.html">Jakarta Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Advanced</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/security-authentication/security-authentication.html">Jakarta Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/security-authorization/security-authorization.html">Jakarta Authorization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/transactions/transactions.html">Jakarta Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/concurrency-utilities/concurrency-utilities.html">Jakarta Concurrency</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../supporttechs/connectors/connectors.html">Jakarta Connectors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Optional Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-el/faces-el.html">Jakarta Expression Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Jakarta XML Binding</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Archived</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-pages/jakarta-pages.html">Jakarta Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-tags/jakarta-tags.html">Jakarta Tags</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/xml-websvcs/xml-websvcs.html">XML Web Services</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ejb-full/ejb-full.html">Jakarta Enterprise Beans Full</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jakarta EE Tutorial</span>
    <span class="version">10</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Jakarta EE Tutorial</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">10</a>
        </li>
        <li class="version">
          <a href="../../../9.1/index.html">9.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Jakarta EE Tutorial</a></li>
    <li>Jakarta EE Web Profile</li>
    <li>Jakarta Enterprise Beans Lite</li>
    <li><a href="ejb-async.html">Using Asynchronous Method Invocation in Session Beans</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">10</button>
  <div class="version-menu">
    <a class="version is-current" href="ejb-async.html">10</a>
    <a class="version" href="../../../9.1/entbeans/ejb-async/ejb-async.html">9.1</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jhammen/jakartaee-tutorial/edit/main/src/main/antora/modules/entbeans/pages/ejb-async/ejb-async.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Using Asynchronous Method Invocation in Session Beans</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We are working on a fresh, updated Jakarta EE Tutorial. This section hasn&#8217;t yet been updated.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This chapter discusses how to implement asynchronous business methods in session beans and call them from enterprise bean clients.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asynchronous_method_invocation"><a class="anchor" href="#_asynchronous_method_invocation"></a>Asynchronous Method Invocation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Session beans can implement asynchronous methods, business methods where control is returned to the client by the enterprise bean container before the method is invoked on the session bean instance.
Clients may then use the Java SE concurrency API to retrieve the result, cancel the invocation, and check for exceptions.
Asynchronous methods are typically used for long-running operations, for processor-intensive tasks, for background tasks, to increase application throughput, or to improve application response time if the method invocation result isn&#8217;t required immediately.</p>
</div>
<div class="paragraph">
<p>When a session bean client invokes a typical non-asynchronous business method, control is not returned to the client until the method has completed.
Clients calling asynchronous methods, however, immediately have control returned to them by the enterprise bean container.
This allows the client to perform other tasks while the method invocation completes.
If the method returns a result, the result is an implementation of the <code>java.util.concurrent.Future&lt;V&gt;</code> interface, where "V" is the result value type.
The <code>Future&lt;V&gt;</code> interface defines methods the client may use to check whether the computation is completed, wait for the invocation to complete, retrieve the final result, and cancel the invocation.</p>
</div>
<div class="sect2">
<h3 id="_creating_an_asynchronous_business_method"><a class="anchor" href="#_creating_an_asynchronous_business_method"></a>Creating an Asynchronous Business Method</h3>
<div class="paragraph">
<p>Annotate a business method with <code>jakarta.ejb.Asynchronous</code> to mark that method as an asynchronous method, or apply <code>@Asynchronous</code> at the class level to mark all the business methods of the session bean as asynchronous methods.
Session bean methods that expose web services can&#8217;t be asynchronous.</p>
</div>
<div class="paragraph">
<p>Asynchronous methods must return either <code>void</code> or an implementation of the <code>Future&lt;V&gt;</code> interface.
Asynchronous methods that return <code>void</code> can&#8217;t declare application exceptions, but if they return <code>Future&lt;V&gt;</code>, they may declare application exceptions.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Asynchronous
public Future&lt;String&gt; processPayment(Order order) throws PaymentException { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method will attempt to process the payment of an order, and return the status as a <code>String</code>.
Even if the payment processor takes a long time, the client can continue working, and display the result when the processing finally completes.</p>
</div>
<div class="paragraph">
<p>The <code>jakarta.ejb.AsyncResult&lt;V&gt;</code> class is a concrete implementation of the <code>Future&lt;V&gt;</code> interface provided as a helper class for returning asynchronous results.
<code>AsyncResult</code> has a constructor with the result as a parameter, making it easy to create <code>Future&lt;V&gt;</code> implementations.
For example, the <code>processPayment</code> method would use <code>AsyncResult</code> to return the status as a <code>String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Asynchronous
public Future&lt;String&gt; processPayment(Order order) throws PaymentException {
    ...
    String status = ...;
    return new AsyncResult&lt;String&gt;(status);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is returned to the enterprise bean container, not directly to the client, and the enterprise bean container makes the result available to the client.
The session bean can check whether the client requested that the invocation be cancelled by calling the <code>jakarta.ejb.SessionContext.wasCancelled</code> method.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Asynchronous
public Future&lt;String&gt; processPayment(Order order) throws PaymentException {
    ...
    if (SessionContext.wasCancelled()) {
        // clean up
    } else {
        // process the payment
    }
    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_calling_asynchronous_methods_from_enterprise_bean_clients"><a class="anchor" href="#_calling_asynchronous_methods_from_enterprise_bean_clients"></a>Calling Asynchronous Methods from Enterprise Bean Clients</h3>
<div class="paragraph">
<p>Session bean clients call asynchronous methods just like non-asynchronous business methods.
If the asynchronous method returns a result, the client receives a <code>Future&lt;V&gt;</code> instance as soon as the method is invoked.
This instance can be used to retrieve the final result, cancel the invocation, check whether the invocation has completed, check whether any exceptions were thrown during processing, and check whether the invocation was cancelled.</p>
</div>
<div class="sect3">
<h4 id="_retrieving_the_final_result_from_an_asynchronous_method_invocation"><a class="anchor" href="#_retrieving_the_final_result_from_an_asynchronous_method_invocation"></a>Retrieving the Final Result from an Asynchronous Method Invocation</h4>
<div class="paragraph">
<p>The client may retrieve the result using one of the <code>Future&lt;V&gt;.get</code> methods.
If processing hasn&#8217;t been completed by the session bean handling the invocation, calling one of the <code>get</code> methods will result in the client halting execution until the invocation completes.
Use the <code>Future&lt;V&gt;.isDone</code> method to determine whether processing has completed before calling one of the <code>get</code> methods.</p>
</div>
<div class="paragraph">
<p>The <code>get()</code> method returns the result as the type specified in the type value of the <code>Future&lt;V&gt;</code> instance.
For example, calling <code>Future&lt;String&gt;.get()</code> will return a <code>String</code> object.
If the method invocation was cancelled, calls to <code>get()</code> result in a <code>java.util.concurrent.CancellationException</code> being thrown.
If the invocation resulted in an exception during processing by the session bean, calls to <code>get()</code> result in a <code>java.util.concurrent.ExecutionException</code> being thrown.
The cause of the <code>ExecutionException</code> may be retrieved by calling the <code>ExecutionException.getCause</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>get(long timeout, java.util.concurrent.TimeUnit unit)</code> method is similar to the <code>get()</code> method, but allows the client to set a timeout value.
If the timeout value is exceeded, a <code>java.util.concurrent.TimeoutException</code> is thrown.
See the Javadoc for the <code>TimeUnit</code> class for the available units of time to specify the timeout value.</p>
</div>
</div>
<div class="sect3">
<h4 id="_cancelling_an_asynchronous_method_invocation"><a class="anchor" href="#_cancelling_an_asynchronous_method_invocation"></a>Cancelling an Asynchronous Method Invocation</h4>
<div class="paragraph">
<p>Call the <code>cancel(boolean mayInterruptIfRunning)</code> method on the <code>Future&lt;V&gt;</code> instance to attempt to cancel the method invocation.
The <code>cancel</code> method returns <code>true</code> if the cancellation was successful and <code>false</code> if the method invocation cannot be cancelled.</p>
</div>
<div class="paragraph">
<p>When the invocation cannot be cancelled, the <code>mayInterruptIfRunning</code> parameter is used to alert the session bean instance on which the method invocation is running that the client attempted to cancel the invocation.
If <code>mayInterruptIfRunning</code> is set to <code>true</code>, calls to <code>SessionContext.wasCancelled</code> by the session bean instance will return <code>true</code>.
If <code>mayInterruptIfRunning</code> is to set <code>false</code>, calls to <code>SessionContext.wasCancelled</code> by the session bean instance will return <code>false</code>.</p>
</div>
<div class="paragraph">
<p>The <code>Future&lt;V&gt;.isCancelled</code> method is used to check whether the method invocation was cancelled before the asynchronous method invocation completed by calling <code>Future&lt;V&gt;.cancel</code>.
The <code>isCancelled</code> method returns <code>true</code> if the invocation was cancelled.</p>
</div>
</div>
<div class="sect3">
<h4 id="_checking_the_status_of_an_asynchronous_method_invocation"><a class="anchor" href="#_checking_the_status_of_an_asynchronous_method_invocation"></a>Checking the Status of an Asynchronous Method Invocation</h4>
<div class="paragraph">
<p>The <code>Future&lt;V&gt;.isDone</code> method returns <code>true</code> if the session bean instance completed processing the method invocation.
The <code>isDone</code> method returns <code>true</code> if the asynchronous method invocation completed normally, was cancelled, or resulted in an exception.
That is, <code>isDone</code> indicates only whether the session bean has completed processing the invocation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_async_example_application"><a class="anchor" href="#_the_async_example_application"></a>The async Example Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>async</code> example demonstrates how to define an asynchronous business method on a session bean and call it from a web client.
This example contains two modules.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A web application (<code>async-war</code>) that contains a stateless session bean and a Jakarta Faces interface.
The <code>MailerBean</code> stateless session bean defines an asynchronous method, <code>sendMessage</code>, which uses the Jakarta Mail API to send an email to an specified email address.</p>
</li>
<li>
<p>An auxiliary Java SE program (<code>async-smtpd</code>) that simulates an SMTP server.
This program listens on TCP port 3025 for SMTP requests and prints the email messages to the standard output (instead of delivering them).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following section describes the architecture of the <code>async-war</code> module.</p>
</div>
<div class="sect2">
<h3 id="_architecture_of_the_async_war_module"><a class="anchor" href="#_architecture_of_the_async_war_module"></a>Architecture of the async-war Module</h3>
<div class="paragraph">
<p>The <code>async-war</code> module consists of a single stateless session bean, <code>MailerBean</code>, and a Jakarta Faces web application front end that uses Facelets tags in XHTML files to display a form for users to enter the email address for the recipient of an email.
The status of the email is updated when the email is finally sent.</p>
</div>
<div class="paragraph">
<p>The <code>MailerBean</code> session bean injects a Jakarta Mail resource used to send an email message to an address specified by the user.
The message is created, modified, and sent using the Jakarta Mail API.
The session bean looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
@Stateless
public class MailerBean {
    @Resource(name="mail/myExampleSession")
    private Session session;
    private static final Logger logger =
            Logger.getLogger(MailerBean.class.getName());

    @Asynchronous
    public Future&lt;String&gt; sendMessage(String email) {
        String status;
        try {
            Properties properties = new Properties();
            properties.put("mail.smtp.port", "3025");
            session = Session.getInstance(properties);
            Message message = new MimeMessage(session);
            message.setFrom();
            message.setRecipients(Message.RecipientType.TO,
                    InternetAddress.parse(email, false));
            message.setSubject("Test message from async example");
            message.setHeader("X-Mailer", "Jakarta Mail");
            DateFormat dateFormatter = DateFormat
                    .getDateTimeInstance(DateFormat.LONG, DateFormat.SHORT);
            Date timeStamp = new Date();
            String messageBody = "This is a test message from the async "
                    + "example of the Jakarta EE Tutorial. It was sent on "
                    + dateFormatter.format(timeStamp)
                    + ".";
            message.setText(messageBody);
            message.setSentDate(timeStamp);
            Transport.send(message);
            status = "Sent";
            logger.log(Level.INFO, "Mail sent to {0}", email);
        } catch (MessagingException ex) {
            logger.severe("Error in sending message.");
            status = "Encountered an error: " + ex.getMessage();
            logger.severe(ex.getMessage());
        }
        return new AsyncResult&lt;&gt;(status);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The injected Jakarta Mail resource can be configured through the GlassFish Server Administration Console, through a GlassFish Server administrative command, or through a resource configuration file packaged with the application.
The resource configuration can be modified at runtime by the GlassFish Server administrator to use a different mail server or transport protocol.</p>
</div>
<div class="paragraph">
<p>The web client consists of a Facelets template, <code>template.xhtml</code>; two Facelets clients, <code>index.xhtml</code> and <code>response.xhtml</code>.
The <code>index.xhtml</code> file contains a form for the target email address.
When the user submits the form, the method is called that uses an injected instance of the <code>MailerBean</code> session bean to call <code>MailerBean.sendMessage</code>.
The result is sent to the <code>response.xhtml</code> Facelets view.</p>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_async_example"><a class="anchor" href="#_running_the_async_example"></a>Running the async Example</h3>
<div class="paragraph">
<p>You can use either NetBeans IDE or Maven to build, package, deploy, and run the <code>async</code> example.</p>
</div>
<div class="sect3">
<h4 id="_to_run_the_async_example_application_using_netbeans_ide"><a class="anchor" href="#_to_run_the_async_example_application_using_netbeans_ide"></a>To Run the async Example Application Using NetBeans IDE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_glassfish_server" class="xref page">Starting and Stopping GlassFish Server</a>).</p>
</li>
<li>
<p>From the <strong>File</strong> menu, choose <strong>Open Project</strong>.</p>
</li>
<li>
<p>In the <strong>Open Project</strong> dialog box, navigate to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/ejb</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <code>async</code> folder, select <strong>Open Required Projects</strong>, and click <strong>Open Project</strong>.</p>
</li>
<li>
<p>In the <strong>Projects</strong> tab, right-click the <code>async-smtpd</code> project and select <strong>Run</strong>.</p>
<div class="paragraph">
<p>The SMTP server simulator starts accepting connections.
The async-smptd output tab shows the following message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">[Test SMTP server listening on port 3025]</code></pre>
</div>
</div>
</li>
<li>
<p>In the <strong>Projects</strong> tab, right-click the <code>async-war</code> project and select <strong>Build</strong>.</p>
<div class="paragraph">
<p>This command configures the Jakarta Mail resource using a GlassFish Server administrative command and builds, packages, and deploys the <code>async-war</code> module.</p>
</div>
</li>
<li>
<p>Open the following URL in a web browser window:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">http://localhost:8080/async-war</code></pre>
</div>
</div>
</li>
<li>
<p>In the web browser window, enter an email address and click Send email.</p>
<div class="paragraph">
<p>The <code>MailerBean</code> stateless bean uses the Jakarta Mail API to deliver an email to the SMTP server simulator.
The async-smptd output window in NetBeans IDE shows the resulting email message, including its headers.</p>
</div>
</li>
<li>
<p>To stop the SMTP server simulator, click the X button on the right side of the status bar in NetBeans IDE.</p>
</li>
<li>
<p>Delete the Jakarta Mail session resource.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Services tab, expand the Servers node, then expand the GlassFish Server server node.</p>
</li>
<li>
<p>Expand the Resources node, then expand the Jakarta Mail Sessions node.</p>
</li>
<li>
<p>Right-click mail/myExampleSession and select Unregister.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_to_run_the_async_example_application_using_maven"><a class="anchor" href="#_to_run_the_async_example_application_using_maven"></a>To Run the async Example Application Using Maven</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that GlassFish Server has been started (see <a href="../../intro/usingexamples/usingexamples.html#_starting_and_stopping_glassfish_server" class="xref page">Starting and Stopping GlassFish Server</a>).</p>
</li>
<li>
<p>In a terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/ejb/async/async-smtpd/</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to build and package the SMTP server simulator:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">mvn install</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to start the STMP server simulator:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">mvn exec:java</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following message appears:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">[Test SMTP server listening on port 3025]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Keep this terminal window open.</p>
</div>
</li>
<li>
<p>In a new terminal window, go to:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">jakartaee-examples/tutorial/ejb/async/async-war</code></pre>
</div>
</div>
</li>
<li>
<p>Enter the following command to configure the Jakarta Mail resource and to build, package, and deploy the <code>async-war</code> module:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">mvn install</code></pre>
</div>
</div>
</li>
<li>
<p>Open the following URL in a web browser window:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">http://localhost:8080/async-war</code></pre>
</div>
</div>
</li>
<li>
<p>In the web browser window, enter an email address and click Send email.</p>
<div class="paragraph">
<p>The <code>MailerBean</code> stateless bean uses the Jakarta Mail API to deliver an email to the SMTP server simulator.
The resulting email message appears on the first terminal window, including its headers.</p>
</div>
</li>
<li>
<p>To stop the SMTP server simulator, close the terminal window in which you issued the command to start the STMP server simulator.</p>
</li>
<li>
<p>To delete the Jakarta Mail session resource, type the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin delete-mail-resource mail/myExampleSession</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
