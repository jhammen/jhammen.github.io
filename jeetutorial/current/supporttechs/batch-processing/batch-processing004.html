<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Jakarta EE Documentation</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
    <script>!function (theme) {
        if (theme === 'dark') document.documentElement.classList.add('theme-dark')
      }(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)') && 'dark'))
    </script>
      </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a id="site-title" class="navbar-item" href="../../../..">Jakarta EE Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
<!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
 -->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="../../../../jakartaee-tutorial/10/jakarta-ee-tutorial.pdf">Download</a>
          </span>
        </div>
      </div>
      <div class="navbar-theme-switcher">
        <span class="switch" title="Switch between Light and Dark Theme">
          <input id="theme-switcher-checkbox" type="checkbox" />
          <label for="theme-switcher-checkbox">Dark Theme</label>
        </span>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jakartaee-tutorial" data-version="10">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Jakarta EE Tutorial</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/usingexamples/usingexamples.html">Using the Tutorial Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Core Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basic/cdi-basic.html">Introduction to Jakarta Contexts and Dependency Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basicexamples/cdi-basicexamples.html">Running the Basic Contexts and Dependency Injection Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interceptors/interceptors.html">Using Jakarta EE Interceptors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs/jaxrs.html">Building RESTful Web Services with Jakarta REST</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-client/jaxrs-client.html">Accessing REST Resources with the Jakarta REST Client API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-advanced/jaxrs-advanced.html">Jakarta REST: Advanced Topics and an Example</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta JSON</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonb/jsonb.html">JSON Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonp/jsonp.html">JSON Processing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Full</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv/cdi-adv.html">Jakarta Contexts and Dependency Injection: Advanced Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-bootstrap-se8/cdi-bootstrap-se8.html">Bootstrapping a CDI Container in Java SE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv-examples/cdi-adv-examples.html">Running the Advanced Contexts and Dependency Injection Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Validation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation/bean-validation.html">Introduction to Jakarta Bean Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation-advanced/bean-validation-advanced.html">Bean Validation: Advanced Topics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../security/security.html">Jakarta Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Servlets</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webapp/webapp.html">Getting Started with Web Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/servlets/servlets.html">Jakarta Servlet Technology</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Faces</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-intro/faces-intro.html">Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-facelets/faces-facelets.html">Introduction to Facelets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page/faces-page.html">Using Jakarta Faces Technology in Web Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page-core/faces-page-core.html">Using Converters, Listeners, and Validators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-develop/faces-develop.html">Developing with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ajax/faces-ajax.html">Using Ajax with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-advanced-cc/faces-advanced-cc.html">Composite Components: Advanced Topics and an Example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-custom/faces-custom.html">Creating Custom UI Components and Other Custom Objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-configure/faces-configure.html">Configuring Jakarta Faces Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ws/faces-ws.html">Using WebSockets with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webi18n/webi18n.html">Internationalizing and Localizing Web Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../web/websocket/websocket.html">Jakarta WebSocket</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-intro/persistence-intro.html">Introduction to Jakarta Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-basicexamples/persistence-basicexamples.html">Running the Persistence Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-querylanguage/persistence-querylanguage.html">The Jakarta Persistence Query Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-criteria/persistence-criteria.html">Using the Criteria API to Create Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-string-queries/persistence-string-queries.html">Creating and Using String-Based Criteria Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-locking/persistence-locking.html">Controlling Concurrent Access to Entity Data with Locking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-entitygraphs/persistence-entitygraphs.html">Creating Fetch Plans with Entity Graphs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-cache/persistence-cache.html">Using a Second-Level Cache with Jakarta Persistence Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Enterprise Beans Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-intro/ejb-intro.html">Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-gettingstarted/ejb-gettingstarted.html">Getting Started with Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-basicexamples/ejb-basicexamples.html">Running the Enterprise Bean Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-async/ejb-async.html">Using Asynchronous Method Invocation in Session Beans</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../messaging/mail-api/mail-api.html">Jakarta Mail</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Messaging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-concepts/jms-concepts.html">Jakarta Messaging Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-examples/jms-examples.html">Jakarta Messaging Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="batch-processing.html">Jakarta Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Advanced</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/security-authentication/security-authentication.html">Jakarta Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/security-authorization/security-authorization.html">Jakarta Authorization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transactions/transactions.html">Jakarta Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../concurrency-utilities/concurrency-utilities.html">Jakarta Concurrency</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/connectors.html">Jakarta Connectors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Optional Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-el/faces-el.html">Jakarta Expression Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Jakarta XML Binding</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Archived</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-pages/jakarta-pages.html">Jakarta Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-tags/jakarta-tags.html">Jakarta Tags</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/xml-websvcs/xml-websvcs.html">XML Web Services</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-full/ejb-full.html">Jakarta Enterprise Beans Full</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jakarta EE Tutorial</span>
    <span class="version">10</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Jakarta EE Tutorial</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">10</a>
        </li>
        <li class="version">
          <a href="../../../9.1/index.html">9.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">10</button>
  <div class="version-menu">
    <a class="version is-current" href="batch-processing004.html">10</a>
    <a class="version" href="../../../9.1/supporttechs/batch-processing/batch-processing004.html">9.1</a>
  </div>
</div>
  <div class="edit-this-page"><a href="file:///home/john/workspace/virtua/jakartaee-tutorial/src/main/antora/modules/supporttechs/pages/batch-processing/batch-processing004.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_using_the_job_specification_language"><a class="anchor" href="#_using_the_job_specification_language"></a>Using the Job Specification Language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Job Specification Language (JSL) enables you to define the steps in a job and their execution order using an XML file.
The following example shows how to define a simple job that contains one chunk step and one task step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;job id="loganalysis" xmlns="https://jakarta.ee/xml/ns/jakartaee"
                      version="2.0"&gt;
  &lt;properties&gt;
    &lt;property name="input_file" value="input1.txt"/&gt;
    &lt;property name="output_file" value="output2.txt"/&gt;
  &lt;/properties&gt;

  &lt;step id="logprocessor" next="cleanup"&gt;
    &lt;chunk checkpoint-policy="item" item-count="10"&gt;
      &lt;reader ref="com.example.pkg.LogItemReader"&gt;&lt;/reader&gt;
      &lt;processor ref="com.example.pkg.LogItemProcessor"&gt;&lt;/processor&gt;
      &lt;writer ref="com.example.pkg.LogItemWriter"&gt;&lt;/writer&gt;
    &lt;/chunk&gt;
  &lt;/step&gt;

  &lt;step id="cleanup"&gt;
    &lt;batchlet ref="com.example.pkg.CleanUp"&gt;&lt;/batchlet&gt;
    &lt;end on="COMPLETED"/&gt;
  &lt;/step&gt;
&lt;/job&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example defines the <code>loganalysis</code> batch job, which consists of the <code>logprocessor</code> chunk step and the <code>cleanup</code> task step.
The <code>logprocessor</code> step transitions to the <code>cleanup</code> step, which terminates the job when completed.</p>
</div>
<div class="paragraph">
<p>The <code>job</code> element defines two properties, <code>input_file</code> and <code>output_file</code>.
Specifying properties in this manner enables you to run a batch job with different configuration parameters without having to recompile its Java batch artifacts.
The batch artifacts can access these properties using the context objects from the batch runtime.</p>
</div>
<div class="paragraph">
<p>The <code>logprocessor</code> step is a chunk step that specifies batch artifacts for the reader (<code>LogItemReader</code>), the processor (<code>LogItemProcessor</code>), and the writer (<code>LogItemWriter</code>).
This step creates a checkpoint for every ten items processed.</p>
</div>
<div class="paragraph">
<p>The <code>cleanup</code> step is a task step that specifies the <code>CleanUp</code> class as its batch artifact.
The job terminates when this step completes.</p>
</div>
<div class="paragraph">
<p>The following sections describe the elements of the Job Specification Language (JSL) in more detail and show the most common attributes and child elements.</p>
</div>
<div class="sect2">
<h3 id="_the_job_element"><a class="anchor" href="#_the_job_element"></a>The job Element</h3>
<div class="paragraph">
<p>The <code>job</code> element is always the top-level element in a job definition file.
Its main attributes are <code>id</code> and <code>restartable</code>.
The <code>job</code> element can contain one <code>properties</code> element and zero or more of each of the following elements: <code>listener</code>, <code>step</code>, <code>flow</code>, and <code>split</code>.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;job id="jobname" restartable="true"&gt;
  &lt;listeners&gt;
    &lt;listener ref="com.example.pkg.ListenerBatchArtifact"/&gt;
  &lt;/listeners&gt;
  &lt;properties&gt;
    &lt;property name="propertyName1" value="propertyValue1"/&gt;
    &lt;property name="propertyName2" value="propertyValue2"/&gt;
  &lt;/properties&gt;
  &lt;step ...&gt; ... &lt;/step&gt;
  &lt;step ...&gt; ... &lt;/step&gt;
  &lt;decision ...&gt; ... &lt;/decision&gt;
  &lt;flow ...&gt; ... &lt;/flow&gt;
  &lt;split ...&gt; ... &lt;/split&gt;
&lt;/job&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>listener</code> element specifies a batch artifact whose methods are invoked before and after the execution of the job.
The batch artifact is an implementation of the <code>jakarta.batch.api.listener.JobListener</code> interface.
See <a href="batch-processing.html#_the_listener_batch_artifacts" class="xref page">The Listener Batch Artifacts</a> for an example of a job listener implementation.</p>
</div>
<div class="paragraph">
<p>The first <code>step</code>, <code>flow</code>, or <code>split</code> element inside the <code>job</code> element executes first.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_step_element"><a class="anchor" href="#_the_step_element"></a>The step Element</h3>
<div class="paragraph">
<p>The <code>step</code> element can be a child of the <code>job</code> and <code>flow</code> elements. Its main attributes are <code>id</code> and <code>next</code>. The <code>step</code> element can contain the following elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One <code>chunk</code> element for chunk-oriented steps or one <code>batchlet</code> element for task-oriented steps.</p>
</li>
<li>
<p>One <code>properties</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a set of properties that batch artifacts can access using batch context objects.</p>
</div>
</li>
<li>
<p>One <code>listener</code> element (optional); one <code>listeners</code> element if more than one listener is specified.</p>
<div class="paragraph">
<p>This element specifies listener artifacts that intercept various phases of step execution.</p>
</div>
<div class="paragraph">
<p>For chunk steps, the batch artifacts for these listeners can be implementations of the following interfaces: <code>StepListener</code>, <code>ItemReadListener</code>, <code>ItemProcessListener</code>, <code>ItemWriteListener</code>, <code>ChunkListener</code>, <code>RetryReadListener</code>, <code>RetryProcessListener</code>, <code>RetryWriteListener</code>, <code>SkipReadListener</code>, <code>SkipProcessListener</code>, and <code>SkipWriteListener</code>.</p>
</div>
<div class="paragraph">
<p>For task steps, the batch artifact for these listeners must be an implementation of the <code>StepListener</code> interface.</p>
</div>
<div class="paragraph">
<p>See <a href="batch-processing.html#_the_listener_batch_artifacts" class="xref page">The Listener Batch Artifacts</a> for an example of an item processor listener implementation.</p>
</div>
</li>
<li>
<p>One <code>partition</code> element (optional).</p>
<div class="paragraph">
<p>This element is used in partitioned steps which execute in more than one thread.</p>
</div>
</li>
<li>
<p>One <code>end</code> element if this is the last step in a job.</p>
<div class="paragraph">
<p>This element sets the batch status to <code>COMPLETED</code>.</p>
</div>
</li>
<li>
<p>One <code>stop</code> element (optional) to stop a job at this step.</p>
<div class="paragraph">
<p>This element sets the batch status to <code>STOPPED</code>.</p>
</div>
</li>
<li>
<p>One <code>fail</code> element (optional) to terminate a job at this step.</p>
<div class="paragraph">
<p>This element sets the batch status to <code>FAILED</code>.</p>
</div>
</li>
<li>
<p>One or more <code>next</code> elements if the <code>next</code> attribute is not specified.</p>
<div class="paragraph">
<p>This element is associated with an exit status and refers to another step, a flow, a split, or a decision element.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example of a chunk step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;step id="stepA" next="stepB"&gt;
  &lt;properties&gt; ... &lt;/properties&gt;
  &lt;listeners&gt;
    &lt;listener ref="MyItemReadListenerImpl"/&gt;
    ...
  &lt;/listeners&gt;
  &lt;chunk ...&gt; ... &lt;/chunk&gt;
  &lt;partition&gt; ... &lt;/partition&gt;
  &lt;end on="COMPLETED" exit-status="MY_COMPLETED_EXIT_STATUS"/&gt;
  &lt;stop on="MY_TEMP_ISSUE_EXIST_STATUS" restart="step0"/&gt;
  &lt;fail on="MY_ERROR_EXIT_STATUS" exit-status="MY_ERROR_EXIT_STATUS"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is an example of a task step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;step id="stepB" next="stepC"&gt;
  &lt;batchlet ...&gt; ... &lt;/batchlet&gt;
  &lt;properties&gt; ... &lt;/properties&gt;
  &lt;listener ref="MyStepListenerImpl"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_the_chunk_element"><a class="anchor" href="#_the_chunk_element"></a>The chunk Element</h4>
<div class="paragraph">
<p>The <code>chunk</code> element is a child of the <code>step</code> element for chunk-oriented steps.
The attributes of this element are listed in <a href="#_attributes_of_the_chunk_element">Attributes of the chunk Element</a>.</p>
</div>
<table id="_attributes_of_the_chunk_element" class="tableblock frame-all grid-all" style="width: 99%;">
<caption class="title">Attributes of the chunk Element</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 75%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>checkpoint-policy</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how to commit the results of processing each chunk:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>"item"</code>: the chunk is committed after processing <code>item-count</code> items</p>
</li>
<li>
<p><code>"custom"</code>: the chunk is committed according to a checkpoint algorithm specified with the <code>checkpoint-algorithm</code> element</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The checkpoint is updated when the results of a chunk are committed.</p>
</div>
<div class="paragraph">
<p>Every chunk is processed in a global Jakarta EE transaction.
If the processing of one item in the chunk fails, the transaction is rolled back and no processed items from this chunk are stored.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"item"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>item-count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of items to process before committing the chunk and taking a checkpoint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time-limit</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies the number of seconds before committing the chunk and taking a checkpoint when <code>checkpoint-policy="item"</code>.</p>
</div>
<div class="paragraph">
<p>If <code>item-count</code> items have not been processed by <code>time-limit</code> seconds, the chunk is committed and a checkpoint is taken.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 (no limit)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buffer-items</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies if processed items are buffered until it is time to take a checkpoint.
If true, a single call to the item writer is made with a list of the buffered items before committing the chunk and taking a checkpoint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of skippable exceptions to skip in this step during chunk processing.
Skippable exception classes are specified with the <code>skippable-exception-classes</code> element.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No limit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>retry-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of attempts to execute this step if retryable exceptions occur.
Retryable exception classes are specified with the <code>retryable-exception-classes</code> element.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No limit</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>chunk</code> element can contain the following elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One <code>reader</code> element.</p>
<div class="paragraph">
<p>This element specifies a batch artifact that implements the <code>ItemReader</code> interface.</p>
</div>
</li>
<li>
<p>One <code>processor</code> element.</p>
<div class="paragraph">
<p>This element specifies a batch artifact that implements the <code>ItemProcessor</code> interface.</p>
</div>
</li>
<li>
<p>One <code>writer</code> element.</p>
<div class="paragraph">
<p>This element specifies a batch artifact that implements the <code>ItemWriter</code> interface.</p>
</div>
</li>
<li>
<p>One <code>checkpoint-algorithm</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a batch artifact that implements the <code>CheckpointAlgorithm</code> interface and provides a custom checkpoint policy.</p>
</div>
</li>
<li>
<p>One <code>skippable-exception-classes</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a set of exceptions thrown from the reader, writer, and processor batch artifacts that chunk processing should skip.
The <code>skip-limit</code> attribute from the <code>chunk</code> element specifies the maximum number of skipped exceptions.</p>
</div>
</li>
<li>
<p>One <code>retryable-exception-classes</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a set of exceptions thrown from the reader, writer, and processor batch artifacts that chunk processing will retry.
The <code>retry-limit</code> attribute from the <code>chunk</code> element specifies the maximum number of attempts.</p>
</div>
</li>
<li>
<p>One <code>no-rollback-exception-classes</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a set of exceptions thrown from the reader, writer, and processor batch artifacts that should not cause the batch runtime to roll back the current chunk, but to retry the current operation without a rollback instead.</p>
</div>
<div class="paragraph">
<p>For exception types not specified in this element, the current chunk is rolled back by default when an exception occurs.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example of a chunk-oriented step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;step id="stepC" next="stepD"&gt;
  &lt;chunk checkpoint-policy="item" item-count="5" time-limit="180"
         buffer-items="true" skip-limit="10" retry-limit="3"&gt;
    &lt;reader ref="pkg.MyItemReaderImpl"&gt;&lt;/reader&gt;
    &lt;processor ref="pkg.MyItemProcessorImpl"&gt;&lt;/processor&gt;
    &lt;writer ref="pkg.MyItemWriterImpl"&gt;&lt;/writer&gt;
    &lt;skippable-exception-classes&gt;
      &lt;include class="pkg.MyItemException"/&gt;
      &lt;exclude class="pkg.MyItemSeriousSubException"/&gt;
    &lt;/skippable-exception-classes&gt;
    &lt;retryable-exception-classes&gt;
      &lt;include class="pkg.MyResourceTempUnavailable"/&gt;
    &lt;/retryable-exception-classes&gt;
  &lt;/chunk&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example defines a chunk step and specifies its reader, processor, and writer artifacts.
The step updates a checkpoint and commits each chunk after processing five items.
It skips all <code>MyItemException</code> exceptions and all its subtypes, except for <code>MyItemSeriousSubException</code>, up to a maximum of ten skipped exceptions.
The step retries a chunk when a <code>MyResourceTempUnavailable</code> exception occurs, up to a maximum of three attempts.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_batchlet_element"><a class="anchor" href="#_the_batchlet_element"></a>The batchlet Element</h4>
<div class="paragraph">
<p>The <code>batchlet</code> element is a child of the <code>step</code> element for task-oriented steps.
This element only has the <code>ref</code> attribute, which specifies a batch artifact that implements the <code>Batchlet</code> interface.
The <code>batch</code> element can contain a <code>properties</code> element.</p>
</div>
<div class="paragraph">
<p>The following is an example of a task-oriented step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;step id="stepD" next="stepE"&gt;
  &lt;batchlet ref="pkg.MyBatchletImpl"&gt;
    &lt;properties&gt;
      &lt;property name="pname" value="pvalue"/&gt;
    &lt;/properties&gt;
  &lt;/batchlet&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example defines a batch step and specifies its batch artifact.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_partition_element"><a class="anchor" href="#_the_partition_element"></a>The partition Element</h4>
<div class="paragraph">
<p>The <code>partition</code> element is a child of the <code>step</code> element.
It indicates that a step is partitioned.
Most partitioned steps are chunk steps where the processing of each item does not depend on the results of processing previous items.
You specify the number of partitions in a step and provide each partition with specific information on which items to process, such as the following.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A range of items.
For example, partition 1 processes items 1 through 500, and partition 2 processes items 501 through 1000.</p>
</li>
<li>
<p>An input source.
For example, partition 1 processes the items in <code>input1.txt</code> and partition 2 processes the items in <code>input2.txt</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the number of partitions, the number of items, and the input sources for a partitioned step are known at development or deployment time, you can use partition properties in the job definition file to specify partition-specific information and access these properties from the step batch artifacts.
The runtime creates as many instances of the step batch artifacts (reader, processor, and writer) as partitions, and each artifact instance receives the properties specific to its partition.</p>
</div>
<div class="paragraph">
<p>In most cases, the number of partitions, the number of items, or the input sources for a partitioned step can only be determined at runtime.
Instead of specifying partition-specific properties statically in the job definition file, you provide a batch artifact that can access your data sources at runtime and determine how many partitions are needed and what range of items each partition should process.
This batch artifact is an implementation of the <code>PartitionMapper</code> interface.
The batch runtime invokes this artifact and then uses the information it provides to instantiate the step batch artifacts (reader, writer, and processor) for each partition and to pass them partition-specific data as parameters.</p>
</div>
<div class="paragraph">
<p>The rest of this section describes the <code>partition</code> element in detail and shows two examples of job definition files: one that uses partition properties to specify a range of items for each partition, and one that relies on a <code>PartitionMapper</code> implementation to determine partition-specific information.</p>
</div>
<div class="paragraph">
<p>See <a href="batch-processing.html#_the_phone_billing_chunk_step" class="xref page">The Phone Billing Chunk Step</a> in <a href="batch-processing.html#_the_phonebilling_example_application" class="xref page">The phonebilling Example Application</a> for a complete example of a partitioned chunk step.</p>
</div>
<div class="paragraph">
<p>The <code>partition</code> element can contain the following elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One <code>plan</code> element, if the <code>mapper</code> element is not specified.</p>
<div class="paragraph">
<p>This element defines the number of partitions, the number of threads, and the properties for each partition in the job definition file.
The <code>plan</code> element is useful when this information is known at development or deployment time.</p>
</div>
</li>
<li>
<p>One <code>mapper</code> element, if the <code>plan</code> element is not specified.</p>
<div class="paragraph">
<p>This element specifies a batch artifact that provides the number of partitions, the number of threads, and the properties for each partition.
The batch artifact is an implementation of the <code>PartitionMapper</code> interface.
You use this option when the information required for each partition is only known at runtime.</p>
</div>
</li>
<li>
<p>One <code>reducer</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a batch artifact that receives control when a partitioned step begins, ends, or rolls back.
The batch artifact enables you to merge results from different partitions and perform other related operations.
The batch artifact is an implementation of the <code>PartitionReducer</code> interface.</p>
</div>
</li>
<li>
<p>One <code>collector</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a batch artifact that sends intermediary results from each partition to a partition analyzer.
The batch artifact sends the intermediary results after each checkpoint for chunk steps and at the end of the step for task steps.
The batch artifact is an implementation of the <code>PartitionCollector</code> interface.</p>
</div>
</li>
<li>
<p>One <code>analyzer</code> element (optional).</p>
<div class="paragraph">
<p>This element specifies a batch artifact that analyzes the intermediary results from the partition collector instances.
The batch artifact is an implementation of the <code>PartitionAnalyzer</code> interface.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example of a partitioned step using the <code>plan</code> element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;step id="stepE" next="stepF"&gt;
  &lt;chunk&gt;
    &lt;reader ...&gt;&lt;/reader&gt;
    &lt;processor ...&gt;&lt;/processor&gt;
    &lt;writer ...&gt;&lt;/writer&gt;
  &lt;/chunk&gt;
  &lt;partition&gt;
    &lt;plan partitions="2" threads="2"&gt;
      &lt;properties partition="0"&gt;
        &lt;property name="firstItem" value="0"/&gt;
        &lt;property name="lastItem" value="500"/&gt;
      &lt;/properties&gt;
      &lt;properties partition="1"&gt;
        &lt;property name="firstItem" value="501"/&gt;
        &lt;property name="lastItem" value="999"/&gt;
      &lt;/properties&gt;
    &lt;/plan&gt;
  &lt;/partition&gt;
  &lt;reducer ref="MyPartitionReducerImpl"/&gt;
  &lt;collector ref="MyPartitionCollectorImpl"/&gt;
  &lt;analyzer ref="MyPartitionAnalyzerImpl"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>plan</code> element specifies the properties for each partition in the job definition file.</p>
</div>
<div class="paragraph">
<p>The following example uses a <code>mapper</code> element instead of a <code>plan</code> element.
The <code>PartitionMapper</code> implementation dynamically provides the same information as the <code>plan</code> element provides in the job definition file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;step id="stepE" next="stepF"&gt;
  &lt;chunk&gt;
    &lt;reader ...&gt;&lt;/reader&gt;
    &lt;processor ...&gt;&lt;/processor&gt;
    &lt;writer ...&gt;&lt;/writer&gt;
  &lt;/chunk&gt;
  &lt;partition&gt;
    &lt;mapper ref="MyPartitionMapperImpl"/&gt;
    &lt;reducer ref="MyPartitionReducerImpl"/&gt;
    &lt;collector ref="MyPartitionCollectorImpl"/&gt;
    &lt;analyzer ref="MyPartitionAnalyzerImpl"/&gt;
  &lt;/partition&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="batch-processing.html#_the_phonebilling_example_application" class="xref page">The phonebilling Example Application</a> for an example implementation of the <code>PartitionMapper</code> interface.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_flow_element"><a class="anchor" href="#_the_flow_element"></a>The flow Element</h3>
<div class="paragraph">
<p>The <code>flow</code> element can be a child of the <code>job</code>, <code>flow</code>, and <code>split</code> elements.
Its attributes are <code>id</code> and <code>next</code>.
Flows can transition to flows, steps, splits, and decision elements.
The <code>flow</code> element can contain the following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One or more <code>step</code> elements</p>
</li>
<li>
<p>One or more <code>flow</code> elements (optional)</p>
</li>
<li>
<p>One or more <code>split</code> elements (optional)</p>
</li>
<li>
<p>One or more <code>decision</code> elements (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last <code>step</code> in a flow is the one with no <code>next</code> attribute or <code>next</code> element.
Steps and other elements in a flow cannot transition to elements outside the flow.</p>
</div>
<div class="paragraph">
<p>The following is an example of the <code>flow</code> element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;flow id="flowA" next="stepE"&gt;
  &lt;step id="flowAstepA" next="flowAstepB"&gt;...&lt;/step&gt;
  &lt;step id="flowAstepB" next="flowAflowC"&gt;...&lt;/step&gt;
  &lt;flow id="flowAflowC" next="flowAsplitD"&gt;...&lt;/flow&gt;
  &lt;split id="flowAsplitD" next="flowAstepE"&gt;...&lt;/split&gt;
  &lt;step id="flowAstepE"&gt;...&lt;/step&gt;
&lt;/flow&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example flow contains three steps, one flow, and one split.
The last step does not have the <code>next</code> attribute.
The flow transitions to <code>stepE</code> when its last step completes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_split_element"><a class="anchor" href="#_the_split_element"></a>The split Element</h3>
<div class="paragraph">
<p>The <code>split</code> element can be a child of the <code>job</code> and <code>flow</code> elements.
Its attributes are <code>id</code> and <code>next</code>.
Splits can transition to splits, steps, flows, and decision elements.
The <code>split</code> element can only contain one or more <code>flow</code> elements that can only transition to other <code>flow</code> elements in the split.</p>
</div>
<div class="paragraph">
<p>The following is an example of a split with three flows that execute concurrently:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;split id="splitA" next="stepB"&gt;
  &lt;flow id="splitAflowA"&gt;...&lt;/flow&gt;
  &lt;flow id="splitAflowB"&gt;...&lt;/flow&gt;
  &lt;flow id="splitAflowC"&gt;...&lt;/flow&gt;
&lt;/split&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_decision_element"><a class="anchor" href="#_the_decision_element"></a>The decision Element</h3>
<div class="paragraph">
<p>The <code>decision</code> element can be a child of the <code>job</code> and <code>flow</code> elements.
Its attributes are <code>id</code> and <code>next</code>.
Steps, flows, and splits can transition to a <code>decision</code> element.
This element specifies a batch artifact that decides the next step, flow, or split to execute based on information from the execution of the previous step, flow, or split.
The batch artifact implements the <code>Decider</code> interface.
The <code>decision</code> element can contain the following elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One or more <code>end</code> elements (optional).</p>
<div class="paragraph">
<p>This element sets the batch status to <code>COMPLETED</code>.</p>
</div>
</li>
<li>
<p>One or more <code>stop</code> elements (optional).</p>
<div class="paragraph">
<p>This element sets the batch status to <code>STOPPED</code>.</p>
</div>
</li>
<li>
<p>One or more <code>fail</code> elements (optional).</p>
<div class="paragraph">
<p>This element sets the batch status to <code>FAILED</code>.</p>
</div>
</li>
<li>
<p>One or more <code>next</code> elements (optional).</p>
</li>
<li>
<p>One <code>properties</code> element (optional).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example of the <code>decider</code> element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;decision id="decisionA" ref="MyDeciderImpl"&gt;
  &lt;fail on="FAILED" exit-status="FAILED_AT_DECIDER"/&gt;
  &lt;end on="COMPLETED" exit-status="COMPLETED_AT_DECIDER"/&gt;
  &lt;stop on="MY_TEMP_ISSUE_EXIST_STATUS" restart="step2"/&gt;
&lt;/decision&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
