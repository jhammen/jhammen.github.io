<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Jakarta EE Documentation</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
    <script>!function (theme) {
        if (theme === 'dark') document.documentElement.classList.add('theme-dark')
      }(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)') && 'dark'))
    </script>
      </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a id="site-title" class="navbar-item" href="../../../..">Jakarta EE Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
<!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
 -->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="../../../../jakartaee-tutorial/10/jakarta-ee-tutorial.pdf">Download</a>
          </span>
        </div>
      </div>
      <div class="navbar-theme-switcher">
        <span class="switch" title="Switch between Light and Dark Theme">
          <input id="theme-switcher-checkbox" type="checkbox" />
          <label for="theme-switcher-checkbox">Dark Theme</label>
        </span>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jakartaee-tutorial" data-version="10">
  <div class="toolbar"></div>
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Jakarta EE Tutorial</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/overview/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../intro/usingexamples/usingexamples.html">Using the Tutorial Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Core Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basic/cdi-basic.html">Introduction to Jakarta Contexts and Dependency Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-basicexamples/cdi-basicexamples.html">Running the Basic Contexts and Dependency Injection Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interceptors/interceptors.html">Using Jakarta EE Interceptors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs/jaxrs.html">Building RESTful Web Services with Jakarta REST</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-client/jaxrs-client.html">Accessing REST Resources with the Jakarta REST Client API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/jaxrs-advanced/jaxrs-advanced.html">Jakarta REST: Advanced Topics and an Example</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta JSON</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonb/jsonb.html">JSON Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jsonp/jsonp.html">JSON Processing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta CDI Full</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv/cdi-adv.html">Jakarta Contexts and Dependency Injection: Advanced Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-bootstrap-se8/cdi-bootstrap-se8.html">Bootstrapping a CDI Container in Java SE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cdi/cdi-adv-examples/cdi-adv-examples.html">Running the Advanced Contexts and Dependency Injection Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Validation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation/bean-validation.html">Introduction to Jakarta Bean Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../beanvalidation/bean-validation-advanced/bean-validation-advanced.html">Bean Validation: Advanced Topics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../security/security.html">Jakarta Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Servlets</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webapp/webapp.html">Getting Started with Web Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/servlets/servlets.html">Jakarta Servlet Technology</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Faces</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-intro/faces-intro.html">Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-facelets/faces-facelets.html">Introduction to Facelets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page/faces-page.html">Using Jakarta Faces Technology in Web Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-page-core/faces-page-core.html">Using Converters, Listeners, and Validators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-develop/faces-develop.html">Developing with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ajax/faces-ajax.html">Using Ajax with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-advanced-cc/faces-advanced-cc.html">Composite Components: Advanced Topics and an Example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-custom/faces-custom.html">Creating Custom UI Components and Other Custom Objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-configure/faces-configure.html">Configuring Jakarta Faces Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-ws/faces-ws.html">Using WebSockets with Jakarta Faces Technology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/webi18n/webi18n.html">Internationalizing and Localizing Web Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../web/websocket/websocket.html">Jakarta WebSocket</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-intro/persistence-intro.html">Introduction to Jakarta Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-basicexamples/persistence-basicexamples.html">Running the Persistence Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-querylanguage/persistence-querylanguage.html">The Jakarta Persistence Query Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-criteria/persistence-criteria.html">Using the Criteria API to Create Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-string-queries/persistence-string-queries.html">Creating and Using String-Based Criteria Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-locking/persistence-locking.html">Controlling Concurrent Access to Entity Data with Locking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-entitygraphs/persistence-entitygraphs.html">Creating Fetch Plans with Entity Graphs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../persist/persistence-cache/persistence-cache.html">Using a Second-Level Cache with Jakarta Persistence Applications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Enterprise Beans Lite</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-intro/ejb-intro.html">Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-gettingstarted/ejb-gettingstarted.html">Getting Started with Enterprise Beans</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-basicexamples/ejb-basicexamples.html">Running the Enterprise Bean Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-async/ejb-async.html">Using Asynchronous Method Invocation in Session Beans</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../messaging/mail-api/mail-api.html">Jakarta Mail</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta Messaging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-concepts/jms-concepts.html">Jakarta Messaging Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging/jms-examples/jms-examples.html">Jakarta Messaging Examples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../batch-processing/batch-processing.html">Jakarta Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Advanced</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/security-authentication/security-authentication.html">Jakarta Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/security-authorization/security-authorization.html">Jakarta Authorization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transactions.html">Jakarta Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../concurrency-utilities/concurrency-utilities.html">Jakarta Concurrency</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/connectors.html">Jakarta Connectors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Optional Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/faces-el/faces-el.html">Jakarta Expression Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Jakarta XML Binding</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Archived</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Web Profile</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-pages/jakarta-pages.html">Jakarta Pages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../web/jakarta-tags/jakarta-tags.html">Jakarta Tags</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jakarta EE Platform</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../websvcs/xml-websvcs/xml-websvcs.html">XML Web Services</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../entbeans/ejb-full/ejb-full.html">Jakarta Enterprise Beans Full</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jakarta EE Tutorial</span>
    <span class="version">10</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Jakarta EE Tutorial</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">10</a>
        </li>
        <li class="version">
          <a href="../../../9.1/index.html">9.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">10</button>
  <div class="version-menu">
    <a class="version is-current" href="transactions004.html">10</a>
    <a class="version" href="../../../9.1/supporttechs/transactions/transactions004.html">9.1</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jhammen/jakartaee-tutorial/edit/main/src/main/antora/modules/supporttechs/pages/transactions/transactions004.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_container_managed_transactions"><a class="anchor" href="#_container_managed_transactions"></a>Container-Managed Transactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In an enterprise bean with container-managed transaction demarcation, the enterprise bean container sets the boundaries of the transactions.
You can use container-managed transactions with any type of enterprise bean: session or message-driven.
Container-managed transactions simplify development because the enterprise bean code does not explicitly mark the transaction&#8217;s boundaries.
The code does not include statements that begin and end the transaction.
By default, if no transaction demarcation is specified, enterprise beans use container-managed transaction demarcation.</p>
</div>
<div class="paragraph">
<p>Typically, the container begins a transaction immediately before an enterprise bean method starts and commits the transaction just before the method exits.
Each method can be associated with a single transaction.
Nested or multiple transactions are not allowed within a method.</p>
</div>
<div class="paragraph">
<p>Container-managed transactions do not require all methods to be associated with transactions.
When developing a bean, you can set the transaction attributes to specify which of the bean&#8217;s methods are associated with transactions.</p>
</div>
<div class="paragraph">
<p>Enterprise beans that use container-managed transaction demarcation must not use any transaction-management methods that interfere with the container&#8217;s transaction demarcation boundaries.
Examples of such methods are the <code>commit</code>, <code>setAutoCommit</code>, and <code>rollback</code> methods of <code>java.sql.Connection</code> or the <code>commit</code> and <code>rollback</code> methods of <code>jakarta.jms.Session</code>.
If you require control over the transaction demarcation, you must use application-managed transaction demarcation.</p>
</div>
<div class="paragraph">
<p>Enterprise beans that use container-managed transaction demarcation also must not use the <code>jakarta.transaction.UserTransaction</code> interface.</p>
</div>
<div class="sect2">
<h3 id="_transaction_attributes"><a class="anchor" href="#_transaction_attributes"></a>Transaction Attributes</h3>
<div class="paragraph">
<p>A transaction attribute controls the scope of a transaction.
<a href="#_transaction_scope">Figure 1, &#8220;Transaction Scope&#8221;</a> illustrates why controlling the scope is important.
In the diagram, <code>method-A</code> begins a transaction and then invokes <code>method-B</code> of <code>Bean-2</code>.
When <code>method-B</code> executes, does it run within the scope of the transaction started by <code>method-A</code>, or does it execute with a new transaction? The answer depends on the transaction attribute of <code>method-B</code>.</p>
</div>
<div id="_transaction_scope" class="imageblock">
<div class="content">
<img src="../../common/_images/jakartaeett_dt_050.svg" alt="A diagram showing a transaction between two beans.">
</div>
<div class="title">Figure 1. Transaction Scope</div>
</div>
<div class="paragraph">
<p>A transaction attribute can have one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Required</code></p>
</li>
<li>
<p><code>RequiresNew</code></p>
</li>
<li>
<p><code>Mandatory</code></p>
</li>
<li>
<p><code>NotSupported</code></p>
</li>
<li>
<p><code>Supports</code></p>
</li>
<li>
<p><code>Never</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_required_attribute"><a class="anchor" href="#_required_attribute"></a>Required Attribute</h4>
<div class="paragraph">
<p>If the client is running within a transaction and invokes the enterprise bean&#8217;s method, the method executes within the client&#8217;s transaction.
If the client is not associated with a transaction, the container starts a new transaction before running the method.</p>
</div>
<div class="paragraph">
<p>The <code>Required</code> attribute is the implicit transaction attribute for all enterprise bean methods running with container-managed transaction demarcation.
You typically do not set the <code>Required</code> attribute unless you need to override another transaction attribute.
Because transaction attributes are declarative, you can easily change them later.</p>
</div>
</div>
<div class="sect3">
<h4 id="_requiresnew_attribute"><a class="anchor" href="#_requiresnew_attribute"></a>RequiresNew Attribute</h4>
<div class="paragraph">
<p>If the client is running within a transaction and invokes the enterprise bean&#8217;s method, the container takes the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Suspends the client&#8217;s transaction</p>
</li>
<li>
<p>Starts a new transaction</p>
</li>
<li>
<p>Delegates the call to the method</p>
</li>
<li>
<p>Resumes the client&#8217;s transaction after the method completes</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the client is not associated with a transaction, the container starts a new transaction before running the method.</p>
</div>
<div class="paragraph">
<p>You should use the <code>RequiresNew</code> attribute when you want to ensure that the method always runs within a new transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mandatory_attribute"><a class="anchor" href="#_mandatory_attribute"></a>Mandatory Attribute</h4>
<div class="paragraph">
<p>If the client is running within a transaction and invokes the enterprise bean&#8217;s method, the method executes within the client&#8217;s transaction.
If the client is not associated with a transaction, the container throws a <code>TransactionRequiredException</code>.</p>
</div>
<div class="paragraph">
<p>Use the <code>Mandatory</code> attribute if the enterprise bean&#8217;s method must use the transaction of the client.</p>
</div>
</div>
<div class="sect3">
<h4 id="_notsupported_attribute"><a class="anchor" href="#_notsupported_attribute"></a>NotSupported Attribute</h4>
<div class="paragraph">
<p>If the client is running within a transaction and invokes the enterprise bean&#8217;s method, the container suspends the client&#8217;s transaction before invoking the method.
After the method has completed, the container resumes the client&#8217;s transaction.</p>
</div>
<div class="paragraph">
<p>If the client is not associated with a transaction, the container does not start a new transaction before running the method.</p>
</div>
<div class="paragraph">
<p>Use the <code>NotSupported</code> attribute for methods that don&#8217;t need transactions.
Because transactions involve overhead, this attribute may improve performance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_supports_attribute"><a class="anchor" href="#_supports_attribute"></a>Supports Attribute</h4>
<div class="paragraph">
<p>If the client is running within a transaction and invokes the enterprise bean&#8217;s method, the method executes within the client&#8217;s transaction.
If the client is not associated with a transaction, the container does not start a new transaction before running the method.</p>
</div>
<div class="paragraph">
<p>Because the transactional behavior of the method may vary, you should use the <code>Supports</code> attribute with caution.</p>
</div>
</div>
<div class="sect3">
<h4 id="_never_attribute"><a class="anchor" href="#_never_attribute"></a>Never Attribute</h4>
<div class="paragraph">
<p>If the client is running within a transaction and invokes the enterprise bean&#8217;s method, the container throws a <code>RemoteException</code>.
If the client is not associated with a transaction, the container does not start a new transaction before running the method.</p>
</div>
</div>
<div class="sect3">
<h4 id="_summary_of_transaction_attributes"><a class="anchor" href="#_summary_of_transaction_attributes"></a>Summary of Transaction Attributes</h4>
<div class="paragraph">
<p><a href="#_transaction_attributes_and_scope">Transaction Attributes and Scope</a> summarizes the effects of the transaction attributes.
Both the <code>T1</code> and the <code>T2</code> transactions are controlled by the container.
A <code>T1</code> transaction is associated with the client that calls a method in the enterprise bean.
In most cases, the client is another enterprise bean.
A <code>T2</code> transaction is started by the container just before the method executes.</p>
</div>
<div class="paragraph">
<p>In the last column of <a href="#_transaction_attributes_and_scope">Transaction Attributes and Scope</a>, the word "None" means that the business method does not execute within a transaction controlled by the container.
However, the database calls in such a business method might be controlled by the transaction manager of the database management system.</p>
</div>
<table id="_transaction_attributes_and_scope" class="tableblock frame-all grid-all" style="width: 60%;">
<caption class="title">Transaction Attributes and Scope</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Transaction Attribute</th>
<th class="tableblock halign-left valign-top">Client&#8217;s Transaction</th>
<th class="tableblock halign-left valign-top">Business Method&#8217;s Transaction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Required</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Required</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RequiresNew</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RequiresNew</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Mandatory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Mandatory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NotSupported</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NotSupported</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Supports</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Supports</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Never</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Never</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_setting_transaction_attributes"><a class="anchor" href="#_setting_transaction_attributes"></a>Setting Transaction Attributes</h4>
<div class="paragraph">
<p>Transaction attributes are specified by decorating the enterprise bean class or method with a <code>jakarta.ejb.TransactionAttribute</code> annotation and setting it to one of the <code>jakarta.ejb.TransactionAttributeType</code> constants.</p>
</div>
<div class="paragraph">
<p>If you decorate the enterprise bean class with <code>@TransactionAttribute</code>, the specified <code>TransactionAttributeType</code> is applied to all the business methods in the class.
Decorating a business method with <code>@TransactionAttribute</code> applies the <code>TransactionAttributeType</code> only to that method.
If a <code>@TransactionAttribute</code> annotation decorates both the class and the method, the method <code>TransactionAttributeType</code> overrides the class <code>TransactionAttributeType</code>.</p>
</div>
<div class="paragraph">
<p>The <code>TransactionAttributeType</code> constants shown in <a href="#_transactionattributetype_constants">TransactionAttributeType Constants</a> encapsulate the transaction attributes described earlier in this section.</p>
</div>
<table id="_transactionattributetype_constants" class="tableblock frame-all grid-all" style="width: 34%;">
<caption class="title">TransactionAttributeType Constants</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Transaction Attribute</th>
<th class="tableblock halign-left valign-top">TransactionAttributeType Constant</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Required</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TransactionAttributeType.REQUIRED</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RequiresNew</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TransactionAttributeType.REQUIRES_NEW</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Mandatory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TransactionAttributeType.MANDATORY</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NotSupported</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TransactionAttributeType.NOT_SUPPORTED</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Supports</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TransactionAttributeType.SUPPORTS</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Never</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TransactionAttributeType.NEVER</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following code snippet demonstrates how to use the <code>@TransactionAttribute</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@TransactionAttribute(NOT_SUPPORTED)
@Stateful
public class TransactionBean implements Transaction {
...
    @TransactionAttribute(REQUIRES_NEW)
    public void firstMethod() {...}

    @TransactionAttribute(REQUIRED)
    public void secondMethod() {...}

    public void thirdMethod() {...}

    public void fourthMethod() {...}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>TransactionBean</code> class&#8217;s transaction attribute has been set to <code>NotSupported</code>, <code>firstMethod</code> has been set to <code>RequiresNew</code>, and <code>secondMethod</code> has been set to <code>Required</code>.
Because a <code>@TransactionAttribute</code> set on a method overrides the class <code>@TransactionAttribute</code>, calls to <code>firstMethod</code> will create a new transaction, and calls to <code>secondMethod</code> will either run in the current transaction or start a new transaction.
Calls to <code>thirdMethod</code> or <code>fourthMethod</code> do not take place within a transaction.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rolling_back_a_container_managed_transaction"><a class="anchor" href="#_rolling_back_a_container_managed_transaction"></a>Rolling Back a Container-Managed Transaction</h3>
<div class="paragraph">
<p>There are two ways to roll back a container-managed transaction.
First, if a system exception is thrown, the container will automatically roll back the transaction.
Second, by invoking the <code>setRollbackOnly</code> method of the <code>EJBContext</code> interface, the bean method instructs the container to roll back the transaction.
If the bean throws an application exception, the rollback is not automatic but can be initiated by a call to <code>setRollbackOnly</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_synchronizing_a_session_beans_instance_variables"><a class="anchor" href="#_synchronizing_a_session_beans_instance_variables"></a>Synchronizing a Session Bean&#8217;s Instance Variables</h3>
<div class="paragraph">
<p>The <code>SessionSynchronization</code> interface, which is optional, allows stateful session bean instances to receive transaction synchronization notifications.
For example, you could synchronize the instance variables of an enterprise bean with their corresponding values in the database.
The container invokes the <code>SessionSynchronization</code> methods (<code>afterBegin</code>, <code>beforeCompletion</code>, and <code>afterCompletion</code>) at each of the main stages of a transaction.</p>
</div>
<div class="paragraph">
<p>The <code>afterBegin</code> method informs the instance that a new transaction has begun.
The container invokes <code>afterBegin</code> immediately before it invokes the business method.</p>
</div>
<div class="paragraph">
<p>The container invokes the <code>beforeCompletion</code> method after the business method has finished but just before the transaction commits.
The <code>beforeCompletion</code> method is the last opportunity for the session bean to roll back the transaction (by calling <code>setRollbackOnly</code>).</p>
</div>
<div class="paragraph">
<p>The <code>afterCompletion</code> method indicates that the transaction has completed.
This method has a single <code>boolean</code> parameter whose value is <code>true</code> if the transaction was committed and <code>false</code> if it was rolled back.</p>
</div>
</div>
<div class="sect2">
<h3 id="_methods_not_allowed_in_container_managed_transactions"><a class="anchor" href="#_methods_not_allowed_in_container_managed_transactions"></a>Methods Not Allowed in Container-Managed Transactions</h3>
<div class="paragraph">
<p>You should not invoke any method that might interfere with the transaction boundaries set by the container.
The following methods are prohibited:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>commit</code>, <code>setAutoCommit</code>, and <code>rollback</code> methods of <code>java.sql.Connection</code></p>
</li>
<li>
<p>The <code>getUserTransaction</code> method of <code>jakarta.ejb.EJBContext</code></p>
</li>
<li>
<p>Any method of <code>jakarta.transaction.UserTransaction</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can, however, use these methods to set boundaries in application-managed transactions.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
